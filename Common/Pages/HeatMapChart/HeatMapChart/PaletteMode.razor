@page "/heatmap-chart/palette-mode"

@using Syncfusion.Blazor
@using Syncfusion.Blazor.HeatMap
@using Syncfusion.Blazor.Buttons;
@using sf_blazor_heatmapdata
@inject NavigationManager NavigationManager
@*Hidden:Lines*@
@inherits SampleBaseComponent;
@*End:Hidden*@

<ActionDescription>
<p>This sample visualizes energy consumption in trillion British thermal units (BTU) by various public sectors of the US government over the years. The data label is disabled, with the tooltip displaying precise data point values.</p>
    
    <p><strong>Palette Type Configuration</strong> - This example demonstrates how to change the palette type between two fundamental color mapping approaches:</p>
    
    <p><strong>Palette Types Supported</strong></p>
    <ul>
        <li><a target="_blank" rel="noopener" href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.HeatMap.PaletteType.html#Syncfusion_Blazor_HeatMap_PaletteType_Fixed" aria-label="Class reference of Fixed type in HeatMap Chart">Fixed</a> - Uses predefined discrete colors for distinct data ranges</li>
        <li><a target="_blank" rel="noopener" href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.HeatMap.PaletteType.html#Syncfusion_Blazor_HeatMap_PaletteType_Gradient" aria-label="Class reference of Gradient type in HeatMap Chart">Gradient</a> - Uses smooth color gradients for continuous value ranges</li>
    </ul>
    
    <p><strong>Palette Configuration</strong> - The palette type can be defined using the <a target="_blank" rel="noopener" href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.HeatMap.HeatMapPaletteSettings.html#Syncfusion_Blazor_HeatMap_HeatMapPaletteSettings_Type" aria-label="Class reference of Type property in HeatMap Chart">Type</a> property in <a target="_blank" rel="noopener" href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.HeatMap.HeatMapPaletteSettings.html" aria-label="Class reference of HeatMapPaletteSettings">PaletteSettings</a>.</p>
    
    <p><strong>Dynamic Legend Switching</strong> - The legend is enabled in this example. When the palette mode is changed, the legend type automatically switches between Gradient and Fixed type legends, providing appropriate visual representation for the selected palette configuration.</p>
    
    <p><strong>Interactive Features</strong> - The tooltip is enabled in this example. Hover the mouse over a data point or tap on touch-enabled devices to view specific energy consumption values for each sector and year.</p>
</ActionDescription>

<div class="col-lg-8 control-section">
    <div class="row">
        <SfHeatMap @ref="Map" DataSource="@DataSource" Theme="@_theme">
            <HeatMapEvents Resized="@Resized"></HeatMapEvents>
            <HeatMapTitleSettings Text="U.S. Government Energy Consumption by Agency (Trillion Btu)">
                <HeatMapTitleTextStyle Size="15px" FontFamily="inherit" FontWeight="500" FontStyle="Normal" TextOverflow="TextOverflow.Trim"></HeatMapTitleTextStyle>
            </HeatMapTitleSettings>
            <HeatMapXAxis Labels="@XLabels"
                          LabelRotation="45"
                          LabelIntersectAction="@LabelIntersectAction.None">
                <HeatMapXAxisTextStyle Color="@AxisLabelColor" FontFamily="inherit"></HeatMapXAxisTextStyle>
            </HeatMapXAxis>
            <HeatMapYAxis Labels="@YLabels">
                <HeatMapYAxisTextStyle Color="@AxisLabelColor" FontFamily="inherit"></HeatMapYAxisTextStyle>
            </HeatMapYAxis>
            <HeatMapPaletteSettings Type="@PalatteType">
                <HeatMapPalettes>
                    <HeatMapPalette Value="4.3" Color="#FFFFDA"></HeatMapPalette>
                    <HeatMapPalette Value="7" Color="#EDF8B6"></HeatMapPalette>
                    <HeatMapPalette Value="9" Color="#CAE8B4"></HeatMapPalette>
                    <HeatMapPalette Value="15" Color="#78D1BD"></HeatMapPalette>
                    <HeatMapPalette Value="25" Color="#208FC6"></HeatMapPalette>
                    <HeatMapPalette Value="30" Color="#253494"></HeatMapPalette>
                    <HeatMapPalette Value="32" Color="#081D58"></HeatMapPalette>
                </HeatMapPalettes>
            </HeatMapPaletteSettings>
            <HeatMapCellSettings ShowLabel="false">
                <HeatMapCellBorder Width="0"></HeatMapCellBorder>
            </HeatMapCellSettings>
            <HeatMapLegendSettings EnableSmartLegend="@SmartLegend" Width="@LegendWidth" Position="LegendPosition.Bottom">
                 <HeatMapLegendTextStyle FontFamily="inherit"></HeatMapLegendTextStyle>
             </HeatMapLegendSettings>
             <HeatMapTooltipSettings>
                 <HeatMapFont FontFamily="inherit"></HeatMapFont>
             </HeatMapTooltipSettings>
        </SfHeatMap>
    </div>
</div>
<PropertyPanel ControlSecClass="col-lg-8" CollapseChanged="HandlePanelCollapseChangedAsync" InitialRefresh="HandlePanelCollapseChangedAsync">
    <table id="property" title="Properties" style="width: 100%">
        <tbody>
        <tr style="height: 50px">
            <td style="width: 50%">
                <div style="font-size: 14px;">Palette Type </div>
            </td>
            <td style="width: 40%;margin-left: 30px">
                <div class="row" style="padding-top: 10px;margin-left: 10px;">
                    <SfRadioButton Label="Fixed" Name="PaletteType" Value="Fixed" @bind-Checked="@Type" ValueChange="@ValueChange" TChecked="string">
                    </SfRadioButton>
                </div>
                <div class="row" style="padding-top: 10px;margin-left: 10px">
                    <SfRadioButton Label="Gradient" Name="PaletteType" Value="Gradient" @bind-Checked="@Type" ValueChange="@ValueChange" TChecked="string"></SfRadioButton>
                </div>
            </td>
        </tr>
        <tr style="height: 50px">
                <td style="width: 40%;">
                    <div>Enable Smart Legend</div>
                 </td>
            <td>
                <div style="margin-left: 10px">
                    <SfCheckBox Checked="@SmartLegend" ValueChange="SmartLegendEnable" Disabled="@EnableSmartLegend" TChecked="bool"></SfCheckBox>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</PropertyPanel>

@code{
    public SfHeatMap<double[,]>? Map { get; set; }
    private Theme _theme { get; set; }
    public string AxisLabelColor = "Black";
    public string LegendWidth = "400px";
    public PaletteType PalatteType = PaletteType.Fixed;
    public string Type = "Fixed";
    public string[] XLabels = new string[] { "2005", "2006", "2007", "2008", "2009", "2010","2011", "2012", "2013", "2014", "2015" };
    public string[] YLabels = new string[] { "Agriculture", "Energy", "Administration", "Health", "Interior", "Justice", "NASA", "Transportation" };
    public double[,] DataSource = HeatMapData.GetPaletteData();
    public bool SmartLegend = true;
    public bool EnableSmartLegend = false;
    public void ValueChange(Syncfusion.Blazor.Buttons.ChangeArgs<string> args)
    {
        if ((string)args.Value == "Fixed")
        {
            PalatteType = PaletteType.Fixed;
            Type = "Fixed";
            EnableSmartLegend = false;
        }
        else
        {
            PalatteType = PaletteType.Gradient;
            Type = "Gradient";
            EnableSmartLegend = true;
        }
    }
    protected override void OnInitialized()
    {
        _theme = HeatmapThemeHelper.GetCurrentHeatmapTheme(NavigationManager.Uri);
        AxisLabelColor = (_theme.ToString().IndexOf("Dark") > -1 || _theme.ToString().IndexOf("HighContrast") > -1) ? "#FFFFFF" : "#000000";
        @*Hidden:Lines*@
        if(SampleService != null && SampleService.IsDevice)
        {
            LegendWidth = string.Empty;
        } else
        {
            @*End:Hidden*@
            LegendWidth = "400px";    
            @*Hidden:Lines*@
        }
        @*End:Hidden*@
    }
    private void Resized(ResizeEventArgs args)
    {
        if (args.CurrentSize.Width <= 550)
        {
            LegendWidth = string.Empty;
        }
        else
        {
            LegendWidth = "400px";
        }
    }
    public void SmartLegendEnable(Syncfusion.Blazor.Buttons.ChangeEventArgs<bool> args)
    {
        SmartLegend = args.Checked;
    }

    /// <summary>
    /// EventCallback handler - invoked when PropertyPanel is expanded/collapsed
    /// This is triggered by CollapseChanged EventCallback from PropertyPanel
    /// </summary>
    public async Task HandlePanelCollapseChangedAsync()
    {
        if (Map != null)
        {
            await Map.RefreshBoundAsync();
        }
    }
}
