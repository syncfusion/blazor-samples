@page "/circular-gauge/clock"

@using System.Timers
@using Syncfusion.Blazor
@using Syncfusion.Blazor.CircularGauge
@*Hidden:Lines*@
@using ThemeHelper
@*End:Hidden*@
@inject NavigationManager NavigationManager
@*Hidden:Lines*@
@inherits SampleBaseComponent
@*End:Hidden*@

<ActionDescription>
<p>This sample demonstrates how to create a fully functional analog clock displaying real-time hours, minutes, and seconds.</p>

<p>Implementation details:</p>
<ul>
  <li>Circular gauge configured with axis, minor ticks, and major ticks</li>
  <li>Multiple needles representing hour, minute, and second hands</li>
  <li>Custom styling for authentic clock appearance</li>
  <li>Live time display with animated needle movement</li>
</ul>

<p>More information on the circular gauge can be found in this <a target="_blank" rel="noopener" href="https://blazor.syncfusion.com/documentation/circular-gauge/getting-started" aria-label="Navigate to the Blazor Circular Gauge Getting Started documentation">documentation section</a>.</p>
</ActionDescription>


<div class="control-section">
    <SfCircularGauge Theme="@Theme" @ref="NeedleRef" Background="transparent">
        <CircularGaugeAxes>
            <CircularGaugeAxis Radius="90%" StartAngle="0" EndAngle="0" Minimum="0" Maximum="12">
                <CircularGaugeAxisLabelStyle HiddenLabel="HiddenLabel.First" Offset="10">
                    <CircularGaugeAxisLabelFont FontFamily="inherit" />
                </CircularGaugeAxisLabelStyle>
                <CircularGaugeAxisLineStyle Width="2" />
                <CircularGaugeAxisMajorTicks Height="15" Interval="1" Width="2" Offset="5" />
                <CircularGaugeAxisMinorTicks Height="10" Width="1" Interval="0.2" Offset="5" />
                <CircularGaugePointers>
                    <CircularGaugePointer Value="10.2" Radius="70%" PointerWidth="3" NeedleStartWidth="2">
                        <CircularGaugePointerAnimation Enable="false" />
                        <CircularGaugeCap Radius="5" Color="white">
                            <CircularGaugeCapBorder Width="1" Color="#00A8B5" />
                        </CircularGaugeCap>
                        <CircularGaugeNeedleTail Length="0%" />
                    </CircularGaugePointer>
                    <CircularGaugePointer Value="2" Radius="100%" PointerWidth="3" NeedleStartWidth="1">
                        <CircularGaugePointerAnimation Enable="false" />
                        <CircularGaugeCap Radius="5" Color="white">
                            <CircularGaugeCapBorder Width="1" Color="#00A8B5" />
                        </CircularGaugeCap>
                        <CircularGaugeNeedleTail Length="0%" />
                    </CircularGaugePointer>
                    <CircularGaugePointer Value="@NeedlePointer" Radius="90%" PointerWidth="3" NeedleStartWidth="1" Color="#00A8B5">
                        <CircularGaugePointerAnimation Enable="false" />
                        <CircularGaugeCap Radius="5" Color="white">
                            <CircularGaugeCapBorder Width="1" Color="#00A8B5" />
                        </CircularGaugeCap>
                        <CircularGaugeNeedleTail Length="25%" Color="#00A8B5" />
                    </CircularGaugePointer>
                </CircularGaugePointers>
                <CircularGaugeAnnotations>
                    <CircularGaugeAnnotation Angle="@SubGaugeOneAngle" Radius="@SubGaugeOneRadius" ZIndex="1">
                        <ContentTemplate>
                            <div style="margin-left: -50%;">
                                <SfCircularGauge Theme="@Theme" Height="150px" Width="150px" Background="transparent">
                                    <CircularGaugeAxes>
                                        <CircularGaugeAxis Radius="70%" StartAngle="0" EndAngle="0" Minimum="0" Maximum="12">
                                            <CircularGaugeAxisLabelStyle HiddenLabel="HiddenLabel.First" Offset="-5">
                                                <CircularGaugeAxisLabelFont FontFamily="inherit" Size="7px" />
                                            </CircularGaugeAxisLabelStyle>
                                            <CircularGaugeAxisLineStyle Width="2" />
                                            <CircularGaugeAxisMajorTicks Interval="2" Offset="2" />
                                            <CircularGaugeAxisMinorTicks Interval="0.4" Offset="2" />
                                            <CircularGaugePointers>
                                                <CircularGaugePointer Value="5" Radius="50%" PointerWidth="2" Color="#00A8B5">
                                                    <CircularGaugePointerAnimation Enable="false" />
                                                    <CircularGaugeCap Radius="0" />
                                                    <CircularGaugeNeedleTail Length="0%" />
                                                </CircularGaugePointer>
                                            </CircularGaugePointers>
                                        </CircularGaugeAxis>
                                    </CircularGaugeAxes>
                                </SfCircularGauge>
                            </div>
                        </ContentTemplate>
                    </CircularGaugeAnnotation>
                    <CircularGaugeAnnotation Angle="@SubGaugeTwoAngle" Radius="@SubGaugeTwoRadius" ZIndex="1">
                        <ContentTemplate>
                            <div style="margin-left: -110%;margin-top: -50%;">
                                <SfCircularGauge Theme="@Theme" Height="150px" Width="150px" Background="transparent">
                                    <CircularGaugeAxes>
                                        <CircularGaugeAxis Radius="70%" StartAngle="0" EndAngle="0" Minimum="0" Maximum="12">
                                            <CircularGaugeAxisLabelStyle HiddenLabel="HiddenLabel.First" Offset="-5">
                                                <CircularGaugeAxisLabelFont FontFamily="inherit" Size="7px" />
                                            </CircularGaugeAxisLabelStyle>
                                            <CircularGaugeAxisLineStyle Width="2" />
                                            <CircularGaugeAxisMajorTicks Interval="2" Offset="2" />
                                            <CircularGaugeAxisMinorTicks Interval="0.4" Offset="2" />
                                            <CircularGaugePointers>
                                                <CircularGaugePointer Value="8" Radius="50%" PointerWidth="2" Color="#00A8B5">
                                                    <CircularGaugePointerAnimation Enable="false" />
                                                    <CircularGaugeCap Radius="0" />
                                                    <CircularGaugeNeedleTail Length="0%" />
                                                </CircularGaugePointer>
                                            </CircularGaugePointers>
                                        </CircularGaugeAxis>
                                    </CircularGaugeAxes>
                                </SfCircularGauge>
                            </div>
                        </ContentTemplate>
                    </CircularGaugeAnnotation>
                </CircularGaugeAnnotations>
            </CircularGaugeAxis>
        </CircularGaugeAxes>
    </SfCircularGauge>
</div>


@code{
    public Theme Theme { get; set; }
    public SfCircularGauge? NeedleRef;
    public double NeedlePointer = 0.2;
    private Timer _syncTimer = null!;
    public string SubGaugeOneRadius = "56%";
    public string SubGaugeTwoRadius = "44%";
    public double SubGaugeOneAngle = 133;
    public double SubGaugeTwoAngle = 118;

    protected override void OnInitialized()
    {
        _syncTimer = new Timer(1000);
        @*Hidden:Lines*@
        #pragma warning disable CS8622
        @*End:Hidden*@
        _syncTimer.Elapsed += this.NeedlePointerUpdate;
        @*Hidden:Lines*@
        #pragma warning restore CS8622
        @*End:Hidden*@
        _syncTimer.AutoReset = true;
        _syncTimer.Enabled = true;
        Theme = ThemeHelper.GetCurrentTheme(NavigationManager.Uri);
        @*Hidden:Lines*@
        if (SampleService != null && SampleService.IsDevice)
        {
            SubGaugeOneRadius = "64%";
            SubGaugeOneAngle = 136;
            SubGaugeTwoAngle = 113;
            SubGaugeTwoRadius = "51%";
        }
        else
        {
            @*End:Hidden*@
            SubGaugeOneRadius = "56%";
            SubGaugeTwoRadius = "44%";
            SubGaugeOneAngle = 133;
            SubGaugeTwoAngle = 118;
            @*Hidden:Lines*@
        }
        @*End:Hidden*@
    }
    public void Dispose()
    {
        if(_syncTimer!=null)
        {
            @*Hidden:Lines*@
            #pragma warning disable CS8622
            @*End:Hidden*@
            _syncTimer.Elapsed -= NeedlePointerUpdate;
            @*Hidden:Lines*@
            #pragma warning restore CS8622
            @*End:Hidden*@
            _syncTimer.Stop();
            _syncTimer.Dispose();
            _syncTimer = null!;
        }
    }
    private void NeedlePointerUpdate(Object source, ElapsedEventArgs e)
    {
        NeedlePointer += 0.2;
        NeedleRef?.SetPointerValueAsync(0, 2, NeedlePointer);
    }
}