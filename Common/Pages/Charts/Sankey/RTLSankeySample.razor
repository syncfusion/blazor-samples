@page "/sankey/Rtl"

@using Syncfusion.Blazor
@using Syncfusion.Blazor.Sankey;
@*Hidden:Lines*@
@using ThemeHelper
@*End:Hidden*@
@inject NavigationManager NavigationManager
@*Hidden:Lines*@
@inherits SampleBaseComponent
@*End:Hidden*@

<ActionDescription>
<p>This RTL Sankey chart demonstrates device-to-content-to-region data usage flows with right-to-left rendering for locales requiring RTL text and layout conventions.</p>

<p>Features:</p>
<ul>
  <li>Visualize device-driven consumption patterns across content types and regions</li>
  <li>Hover over nodes and links to view detailed usage values</li>
  <li>RTL alignment supports right-to-left reading contexts and user preferences</li>
  <li>Maintains full Sankey functionality with regional language support</li>
</ul>

<p>More details: <a target="_blank" rel="noopener" href="https://blazor.syncfusion.com/documentation/sankey" aria-label="Navigate to the documentation for Sankey chart">documentation</a>.</p>
</ActionDescription>



<div class="control-section" align='center'>
    <SfSankey BackgroundColor="@_backgroundColor" EnableAnimation="false" Nodes=@Nodes Links=@Links Width="@_width" Title="@_title" EnableRTL="true" Theme="@_theme" LabelRendering="OnLabelRendering">
    <SankeyTooltipSettings Enable="true"></SankeyTooltipSettings>
    <SankeyLegendSettings Visible="true"></SankeyLegendSettings>
</SfSankey>
</div>
@code {
    Theme _theme;
    string _backgroundColor = "transparent";
    string _width = "90%";
    public List<SankeyDataNode> Nodes = new List<SankeyDataNode>();
    public List<SankeyDataLink> Links = new List<SankeyDataLink>();
private string _title = "Global Internet Traffic Flow";
    protected override void OnInitialized()
    {
        _theme = ThemeHelper.GetCurrentTheme(NavigationManager.Uri);
        string themeName = _theme.ToString().ToLower();
        _backgroundColor = (themeName.IndexOf("dark") > -1 || themeName.IndexOf("contrast") > -1) ? "transparent" : null!;
        Nodes = new List<SankeyDataNode>()
        {
            // Devices
            new SankeyDataNode() { Id = "Smartphones", Label = new SankeyDataLabel() { Text = "Smartphones" } },
            new SankeyDataNode() { Id = "Tablets", Label = new SankeyDataLabel() { Text = "Tablets" } },
            new SankeyDataNode() { Id = "PCs", Label = new SankeyDataLabel() { Text = "PCs" } },
            new SankeyDataNode() { Id = "SmartTVs", Label = new SankeyDataLabel() { Text = "Smart TVs" } },

            // Content Categories
            new SankeyDataNode() { Id = "Video", Label = new SankeyDataLabel() { Text = "Video Streaming" } },
            new SankeyDataNode() { Id = "SocialMedia", Label = new SankeyDataLabel() { Text = "Social Media" } },
            new SankeyDataNode() { Id = "Gaming", Label = new SankeyDataLabel() { Text = "Online Gaming" } },
            new SankeyDataNode() { Id = "WebBrowsing", Label = new SankeyDataLabel() { Text = "Web Browsing" } },

            // Regions
            new SankeyDataNode() { Id = "NorthAmerica", Label = new SankeyDataLabel() { Text = "North America" } },
            new SankeyDataNode() { Id = "Europe", Label = new SankeyDataLabel() { Text = "Europe" } },
            new SankeyDataNode() { Id = "AsiaPacific", Label = new SankeyDataLabel() { Text = "Asia Pacific" } },
            new SankeyDataNode() { Id = "LatinAmerica", Label = new SankeyDataLabel() { Text = "Latin America" } },
            new SankeyDataNode() { Id = "MiddleEastAfrica", Label = new SankeyDataLabel() { Text = "Middle East & Africa" } }
        };

        Links = new List<SankeyDataLink>()
        {
            // Devices to Content Categories
            new SankeyDataLink() { SourceId = "Smartphones", TargetId = "Video", Value = 250 },
            new SankeyDataLink() { SourceId = "Smartphones", TargetId = "SocialMedia", Value = 180 },
            new SankeyDataLink() { SourceId = "Smartphones", TargetId = "Gaming", Value = 120 },
            new SankeyDataLink() { SourceId = "Smartphones", TargetId = "WebBrowsing", Value = 150 },
            new SankeyDataLink() { SourceId = "Tablets", TargetId = "Video", Value = 100 },
            new SankeyDataLink() { SourceId = "Tablets", TargetId = "SocialMedia", Value = 70 },
            new SankeyDataLink() { SourceId = "Tablets", TargetId = "Gaming", Value = 60 },
            new SankeyDataLink() { SourceId = "Tablets", TargetId = "WebBrowsing", Value = 80 },

            new SankeyDataLink() { SourceId = "PCs", TargetId = "Video", Value = 180 },
            new SankeyDataLink() { SourceId = "PCs", TargetId = "SocialMedia", Value = 120 },
            new SankeyDataLink() { SourceId = "PCs", TargetId = "Gaming", Value = 100 },
            new SankeyDataLink() { SourceId = "PCs", TargetId = "WebBrowsing", Value = 200 },
            new SankeyDataLink() { SourceId = "SmartTVs", TargetId = "Video", Value = 150 },
            new SankeyDataLink() { SourceId = "SmartTVs", TargetId = "Gaming", Value = 50 },

            // Content Categories to Regions
            new SankeyDataLink() { SourceId = "Video", TargetId = "NorthAmerica", Value = 220 },
            new SankeyDataLink() { SourceId = "Video", TargetId = "Europe", Value = 180 },
            new SankeyDataLink() { SourceId = "Video", TargetId = "AsiaPacific", Value = 200 },
            new SankeyDataLink() { SourceId = "Video", TargetId = "LatinAmerica", Value = 50 },
            new SankeyDataLink() { SourceId = "Video", TargetId = "MiddleEastAfrica", Value = 30 },
            new SankeyDataLink() { SourceId = "SocialMedia", TargetId = "NorthAmerica", Value = 100 },
            new SankeyDataLink() { SourceId = "SocialMedia", TargetId = "Europe", Value = 90 },
            new SankeyDataLink() { SourceId = "SocialMedia", TargetId = "AsiaPacific", Value = 140 },
            new SankeyDataLink() { SourceId = "SocialMedia", TargetId = "LatinAmerica", Value = 25 },
            new SankeyDataLink() { SourceId = "SocialMedia", TargetId = "MiddleEastAfrica", Value = 15 },

            new SankeyDataLink() { SourceId = "Gaming", TargetId = "NorthAmerica", Value = 80 },
            new SankeyDataLink() { SourceId = "Gaming", TargetId = "Europe", Value = 70 },
            new SankeyDataLink() { SourceId = "Gaming", TargetId = "AsiaPacific", Value = 120 },
            new SankeyDataLink() { SourceId = "Gaming", TargetId = "LatinAmerica", Value = 40 },
            new SankeyDataLink() { SourceId = "Gaming", TargetId = "MiddleEastAfrica", Value = 20 },

            new SankeyDataLink() { SourceId = "WebBrowsing", TargetId = "NorthAmerica", Value = 150 },
            new SankeyDataLink() { SourceId = "WebBrowsing", TargetId = "Europe", Value = 110 },
            new SankeyDataLink() { SourceId = "WebBrowsing", TargetId = "AsiaPacific", Value = 130 },
            new SankeyDataLink() { SourceId = "WebBrowsing", TargetId = "LatinAmerica", Value = 25 },
            new SankeyDataLink() { SourceId = "WebBrowsing", TargetId = "MiddleEastAfrica", Value = 15 }
        };
        base.OnInitialized();
        @*Hidden:Lines*@
        if (SampleService != null && SampleService.IsDevice)
        {
            _width = "100%";
            StateHasChanged();
        }
        @*End:Hidden*@
    }

 
    void OnLabelRendering(SankeyLabelRenderEventArgs args)
    {
        @*Hidden:Lines*@
        if (SampleService != null && SampleService.IsDevice)
        {
            args.Text = args.Text.Substring(0, 3).ToUpper();
        }
        @*End:Hidden*@
    }

}