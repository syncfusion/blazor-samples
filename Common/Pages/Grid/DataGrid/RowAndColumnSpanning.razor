@page "/datagrid/row-and-column-spanning"

@using Syncfusion.Blazor.Grids
@using Syncfusion.Blazor.DropDowns
@using Syncfusion.Blazor.Buttons
@inject IJSRuntime JS
@*Hidden:Lines*@
@using blazor_employeedetails
@*End:Hidden*@

<SampleDescription>
    <p>
        The Blazor DataGrid supports automatic cell merging, allowing adjacent cells with identical values to be combined horizontally, vertically, or in both directions. The provided options help create a cleaner and more readable layout.
    </p>
</SampleDescription>
<ActionDescription>
    <p>This sample demonstrates the options supporting cell merging in the DataGrid. These options are enabled by using the <code><b>AutoSpan</b></code> property of the DataGrid. The <code><b>AutoSpan</b></code> property is bound to a dropdown, which lists options to select a cell merging mode and combine adjacent cells based on the selected mode.</p>
    <p>By default, the dropdown is set to <code><b>AutoSpanMode.HorizontalAndVertical</b></code>, which merges identical cells across both rows and columns for improved readability. Selecting a different <code><b>AutoSpanMode</b></code> option applies the corresponding cell merge behavior. To restore the original grid layout, set the dropdown to <code><b>AutoSpanMode.None</b></code>, which disables cell merging.</p>
    <p><b>Available Modes:</b></p>
    <ul>
        <li><b>None</b> - No merging applied (default)</li>
        <li><b>Row</b> - Merges identical cells horizontally across columns within the same row</li>
        <li><b>Column</b> - Merges identical cells vertically down the same column</li>
        <li><b>HorizontalAndVertical</b> - Applies both horizontal and vertical cell merging simultaneously</li>
    </ul>
    <p>
        More information about the <a target="_blank" href="https://blazor.syncfusion.com/documentation/datagrid/row">row</a> and <a target="_blank" href="https://blazor.syncfusion.com/documentation/datagrid/columns">column</a> spanning feature can be found in the respective documentation link.
    </p>
</ActionDescription>

<div class="form-row alt">
    <div class="left">
        <label class="e-option">Select AutoSpan Mode:</label>
        <SfDropDownList TValue="string" TItem="string"
                        DataSource="@modes"
                        Value="@selectedMode"
                        Width="auto">
            <DropDownListEvents TItem="string" ValueChange="OnModeChanged" TValue="string"></DropDownListEvents>
        </SfDropDownList>
    </div>
</div>

<div class="col-lg-12 control-section">
    <div class="content-wrapper">
        <div class="row">
            <SfGrid DataSource="@EmployeeTimeSheet"
                    AllowSorting="true"
                    AllowFiltering="true"
                    GridLines="GridLine.Both"
                    AutoSpan="@currentMode" AllowSelection="false" EnableHover="false">
                <GridFilterSettings Type="Syncfusion.Blazor.Grids.FilterType.Menu"></GridFilterSettings>
                <GridColumns>
                    <GridColumn Field=@nameof(EmployeeDetails.EmployeeID) HeaderText="Employee ID" Width="150" TextAlign="TextAlign.Right" IsPrimaryKey="true" IsFrozen="true"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.EmployeeName) HeaderText="Employee Name" Width="180" IsFrozen="@enableFrozen"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_9_00) HeaderText="9:00 AM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_9_30) HeaderText="9:30 AM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_10_00) HeaderText="10:00 AM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_10_30) HeaderText="10:30 AM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_11_00) HeaderText="11:00 AM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_11_30) HeaderText="11:30 AM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_12_00) HeaderText="12:00 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_12_30) HeaderText="12:30 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_1_00) HeaderText="1:00 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_1_30) HeaderText="1:30 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_2_00) HeaderText="2:00 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_2_30) HeaderText="2:30 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_3_00) HeaderText="3:00 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_3_30) HeaderText="3:30 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_4_00) HeaderText="4:00 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_4_30) HeaderText="4:30 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                    <GridColumn Field=@nameof(EmployeeDetails.Time_5_00) HeaderText="5:00 PM" Width="150" TextAlign="TextAlign.Center"></GridColumn>
                </GridColumns>
            </SfGrid>
        </div>
    </div>
</div>

@code {
    private AutoSpanMode currentMode = AutoSpanMode.HorizontalAndVertical;
    private string selectedMode = "Horizontal and Vertical";
    private List<string> modes = new() { "None", "Row", "Column", "Horizontal and Vertical" };
    private bool enableFrozen { get; set; } = true;
    @*Hidden:Lines*@
    private bool isDeviceMode { get; set; }
    @*End:Hidden*@
    public List<EmployeeDetails>? EmployeeTimeSheet { get; set; }

    protected override void OnInitialized()
    {
        EmployeeTimeSheet = EmployeeDetails.GetAllRecords();
    }

    @*Hidden:Lines*@
    protected override async void OnAfterRender(bool firstRender)
    {
        base.OnAfterRender(firstRender);
        if (firstRender)
        {
            isDeviceMode = await this.JS.InvokeAsync<bool>("sfBlazorSB.isDeviceMode");
            if (isDeviceMode)
            {
                enableFrozen = false;
                StateHasChanged();
            }
        }
    }
    @*End:Hidden*@

    private void OnModeChanged(ChangeEventArgs<string, string> args)
    {
        selectedMode = args?.Value ?? "None";
        currentMode = selectedMode switch
        {
            "Row" => AutoSpanMode.Row,
            "Column" => AutoSpanMode.Column,
            "Horizontal and Vertical" => AutoSpanMode.HorizontalAndVertical,
            _ => AutoSpanMode.None
        };
    }
}

@*Hidden:Lines*@
<style> 

    .control-section {
        padding-top: 0;
    }

    .form-row.alt {
        display: flex;
        justify-content: space-between; /* Push items to opposite ends */
        align-items: center; /* Vertically align them */
        height:60px;
        padding-top: 10px;
        padding-bottom: 10px;
        width:100%
    }

    .form-row.alt .left {
        display: flex;
        gap: 10px; /* Space between label and input */
        align-items: center;
    }

    .form-row.alt label{
        margin-bottom:0px;
    }
</style>
@*End:Hidden*@