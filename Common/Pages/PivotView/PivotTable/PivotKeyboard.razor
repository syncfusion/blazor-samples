@page "/pivot-table/keyboard-navigation"

@using Syncfusion.Blazor.PivotView

@*Hidden:Lines*@
@inherits SampleBaseComponent; 
@*End:Hidden*@

<ActionDescription>
<p>
    This sample demonstrates comprehensive keyboard navigation for interacting with Pivot Table features including the pivot table, grouping bar, field list, toolbar, calculated field, drill-through, and filter dialog.
  </p>
  <p>
    <strong>Below are the key combinations that can be used in the pivot table to initiate various actions:</strong>
  </p>
  <ul>
    <li>
      <strong>FOCUS</strong>
      <ul>
        <li><span class="key-class"><kbd>Alt</kbd> + <kbd>J</kbd></span> - Focuses on the first component of the sample.</li>
      </ul>
    </li>
    <li>
      <strong>PIVOT TABLE</strong>
      <ul>
        <li><span class="key-class"><kbd>Tab</kbd></span> - Moves cell focus to the right. If no cells are focused, it moves to the next active element in the browser page.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>Tab</kbd></span> - Moves cell focus to the left. If no cells are focused, it moves to the previous active element in the browser page.</li>
        <li><span class="key-class"><kbd>Down arrow</kbd></span> - Moves cell focus downwards.</li>
        <li><span class="key-class"><kbd>Up arrow</kbd></span> - Moves cell focus upwards.</li>
        <li><span class="key-class"><kbd>Left arrow</kbd></span> - Moves cell focus to the left side.</li>
        <li><span class="key-class"><kbd>Right arrow</kbd></span> - Moves cell focus to the right side.</li>
        <li><span class="key-class"><kbd>Home</kbd></span> - Navigates to the first cell in the current row.</li>
        <li><span class="key-class"><kbd>End</kbd></span> - Navigates to the last cell in the current row.</li>
        <li><span class="key-class"><kbd>Ctrl</kbd> + <kbd>Home</kbd></span> - Navigates to the first cell in the table.</li>
        <li><span class="key-class"><kbd>Ctrl</kbd> + <kbd>End</kbd></span> - Navigates to the last cell in the table.</li>
        <li><span class="key-class"><kbd>Enter</kbd></span> - Performs expand/collapse operations on drill cells or value sorting on header cells.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>Enter</kbd></span> - Performs value sorting in ascending or descending order on header cells with value axis.</li>
      </ul>
    </li>
    <li>
      <strong>GROUPING BAR</strong>
      <ul>
        <li><span class="key-class"><kbd>Tab</kbd></span> - Moves to the next active element (field button) in the grouping bar.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>Tab</kbd></span> - Moves to the previous active element (field button) in the grouping bar.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>F</kbd></span> - Opens the filter dialog if the current field button has a filter icon.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>S</kbd></span> - Performs sorting on the selected field if it has a sort icon.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>E</kbd></span> - Opens the calculated field dialog for editing if available.</li>
        <li><span class="key-class"><kbd>Enter</kbd></span> - Performs selection operation or opens the aggregation menu for value fields.</li>
        <li><span class="key-class"><kbd>Delete</kbd></span> - Removes the selected field from the current report.</li>
        <li><span class="key-class"><kbd>Down arrow</kbd></span> - Selects the next item in a dropdown list.</li>
        <li><span class="key-class"><kbd>Up arrow</kbd></span> - Selects the previous item in a dropdown list.</li>
        <li><span class="key-class"><kbd>Home</kbd></span> - Selects the first item in a dropdown list.</li>
        <li><span class="key-class"><kbd>End</kbd></span> - Selects the last item in a dropdown list.</li>
        <li><span class="key-class"><kbd>Alt</kbd> + <kbd>Down</kbd></span> - Opens the dropdown list popup.</li>
        <li><span class="key-class"><kbd>Alt</kbd> + <kbd>Up</kbd></span> - Closes the dropdown list popup.</li>
        <li><span class="key-class"><kbd>Esc</kbd></span> - Closes the dropdown list.</li>
      </ul>
    </li>
    <li>
      <strong>FIELD LIST</strong>
      <ul>
        <li><span class="key-class"><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>F</kbd></span> - Opens the popup field list dialog if enabled.</li>
        <li><span class="key-class"><kbd>Tab</kbd></span> - Moves to the next active element in the field list.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>Tab</kbd></span> - Moves to the previous active element in the field list.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>F</kbd></span> - Opens the filter dialog for the selected field.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>S</kbd></span> - Performs sorting on the selected field.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>E</kbd></span> - Opens the calculated field dialog for editing.</li>
        <li><span class="key-class"><kbd>Enter</kbd></span> - Performs selection operation or opens aggregation menu.</li>
        <li><span class="key-class"><kbd>Delete</kbd></span> - Removes the selected field from the report.</li>
        <li><span class="key-class"><kbd>Down arrow</kbd></span> - Moves to the next tree node.</li>
        <li><span class="key-class"><kbd>Up arrow</kbd></span> - Moves to the previous tree node.</li>
        <li><span class="key-class"><kbd>Left arrow</kbd></span> - Collapses the current tree node.</li>
        <li><span class="key-class"><kbd>Right arrow</kbd></span> - Expands the current tree node.</li>
        <li><span class="key-class"><kbd>Home</kbd></span> - Navigates to the first tree node.</li>
        <li><span class="key-class"><kbd>End</kbd></span> - Navigates to the last tree node.</li>
        <li><span class="key-class"><kbd>Space</kbd></span> - Checks or unchecks tree nodes and checkbox elements.</li>
        <li><span class="key-class"><kbd>Esc</kbd></span> - Closes the popup field list dialog.</li>
      </ul>
    </li>
    <li>
      <strong>TOOLBAR</strong>
      <ul>
        <li><span class="key-class"><kbd>Tab</kbd></span> - Moves to the next active option in the toolbar.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>Tab</kbd></span> - Moves to the previous active option in the toolbar.</li>
        <li><span class="key-class"><kbd>Enter</kbd></span> - Performs the selection operation of the current active element.</li>
      </ul>
    </li>
    <li>
      <strong>CALCULATED FIELD</strong>
      <ul>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>E</kbd></span> - Opens the calculated field dialog for editing.</li>
        <li><span class="key-class"><kbd>Tab</kbd></span> - Moves to the next active element in the dialog.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>Tab</kbd></span> - Moves to the previous active element in the dialog.</li>
        <li><span class="key-class"><kbd>Enter</kbd></span> - Performs selection or copies field name/formula to the formula text area.</li>
        <li><span class="key-class"><kbd>Down arrow</kbd></span> - Moves to the next tree node.</li>
        <li><span class="key-class"><kbd>Up arrow</kbd></span> - Moves to the previous tree node.</li>
        <li><span class="key-class"><kbd>Left arrow</kbd></span> - Collapses the current tree node.</li>
        <li><span class="key-class"><kbd>Right arrow</kbd></span> - Expands the current tree node or opens the aggregation menu.</li>
        <li><span class="key-class"><kbd>Home</kbd></span> - Navigates to the first tree node.</li>
        <li><span class="key-class"><kbd>End</kbd></span> - Navigates to the last tree node.</li>
        <li><span class="key-class"><kbd>Esc</kbd></span> - Closes the dialog.</li>
      </ul>
    </li>
    <li>
      <strong>DRILL THROUGH</strong>
      <ul>
        <li><span class="key-class"><kbd>Tab</kbd></span> - Moves to the next active element in the drill-through dialog.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>Tab</kbd></span> - Moves to the previous active element in the dialog.</li>
        <li><span class="key-class"><kbd>Down arrow</kbd></span> - Moves the row/cell focus downwards.</li>
        <li><span class="key-class"><kbd>Up arrow</kbd></span> - Moves the row/cell focus upwards.</li>
        <li><span class="key-class"><kbd>Left arrow</kbd></span> - Moves the cell focus to the left side.</li>
        <li><span class="key-class"><kbd>Right arrow</kbd></span> - Moves the cell focus to the right side.</li>
        <li><span class="key-class"><kbd>Home</kbd></span> - Navigates to the first cell in the current row.</li>
        <li><span class="key-class"><kbd>End</kbd></span> - Navigates to the last cell in the current row.</li>
        <li><span class="key-class"><kbd>Ctrl</kbd> + <kbd>Home</kbd></span> - Navigates to the first cell in the table.</li>
        <li><span class="key-class"><kbd>Ctrl</kbd> + <kbd>End</kbd></span> - Navigates to the last cell in the table.</li>
        <li><span class="key-class"><kbd>Enter</kbd></span> - Performs selection operation of the current active element.</li>
        <li><span class="key-class"><kbd>Esc</kbd></span> - Deselects rows/cells or closes the drill-through dialog.</li>
        <li><span class="key-class"><kbd>F2</kbd></span> - Deselects all rows/cells or closes the dialog.</li>
        <li><span class="key-class"><kbd>Insert</kbd></span> - Adds a new row/cell in the data grid.</li>
        <li><span class="key-class"><kbd>Delete</kbd></span> - Removes the selected row in the data grid.</li>
      </ul>
    </li>
    <li>
      <strong>FILTER DIALOG</strong>
      <ul>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>F</kbd></span> - Opens the filter dialog for the selected field.</li>
        <li><span class="key-class"><kbd>Tab</kbd></span> - Moves to the next active element in the filter dialog.</li>
        <li><span class="key-class"><kbd>Shift</kbd> + <kbd>Tab</kbd></span> - Moves to the previous active element in the filter dialog.</li>
        <li><span class="key-class"><kbd>Enter</kbd></span> - Performs selection operation or toggles list items.</li>
        <li><span class="key-class"><kbd>Down arrow</kbd></span> - Moves to the next tree node.</li>
        <li><span class="key-class"><kbd>Up arrow</kbd></span> - Moves to the previous tree node.</li>
        <li><span class="key-class"><kbd>Left arrow</kbd></span> - Collapses tree nodes or moves to previous tab.</li>
        <li><span class="key-class"><kbd>Right arrow</kbd></span> - Expands tree nodes or moves to next tab.</li>
        <li><span class="key-class"><kbd>Home</kbd></span> - Navigates to the first tree node.</li>
        <li><span class="key-class"><kbd>End</kbd></span> - Navigates to the last tree node.</li>
        <li><span class="key-class"><kbd>Space</kbd></span> - Checks or unchecks tree nodes and checkbox elements.</li>
        <li><span class="key-class"><kbd>Esc</kbd></span> - Closes the filter dialog.</li>
        <li><span class="key-class"><kbd>Alt</kbd> + <kbd>Down</kbd></span> - Opens dropdown list popup.</li>
        <li><span class="key-class"><kbd>Alt</kbd> + <kbd>Up</kbd></span> - Closes dropdown list popup.</li>
      </ul>
    </li>
  </ul>
  <p>
    For comprehensive information and advanced keyboard navigation options, refer to the <a target="_blank" rel="noopener" href="https://blazor.syncfusion.com/documentation/pivot-table/accessibility#keyboard-navigation" aria-label="Blazor PivotTable Keyboard Navigation documentation">keyboard navigation documentation</a>.
  </p>
</ActionDescription>



<div class="control-section">
    <div class="content-wrapper">
        <SfPivotView @ref="@Pivot" TValue="PivotProductDetails" Height="400" Width="100%" ShowGroupingBar="true" ShowFieldList=true ShowToolbar=true Toolbar="@PivotToolbar" AllowNumberFormatting=true AllowConditionalFormatting=true AllowPdfExport=true AllowExcelExport=true EnableValueSorting=true ShowTooltip=false>
            <PivotViewDataSourceSettings DataSource="@PivotDataSource" ExpandAll=false EnableSorting=true AllowLabelFilter=true AllowMemberFilter=true AllowValueFilter=true>
                <PivotViewColumns>
                    <PivotViewColumn Name="Year"></PivotViewColumn>
                    <PivotViewColumn Name="Order_Source" Caption="Order Source"></PivotViewColumn>
                </PivotViewColumns>
                <PivotViewRows>
                    <PivotViewRow Name="Country"></PivotViewRow>
                    <PivotViewRow Name="Products"></PivotViewRow>
                </PivotViewRows>
                <PivotViewValues>
                    <PivotViewValue Name="In_Stock" Caption="In Stock"></PivotViewValue>
                    <PivotViewValue Name="Sold" Caption="Units Sold"></PivotViewValue>
                    <PivotViewValue Name="Amount" Caption="Sold Amount"></PivotViewValue>
                </PivotViewValues>
                <PivotViewFilters>
                    <PivotViewFilter Name="Product_Categories" Caption="Product Categories"></PivotViewFilter>
                </PivotViewFilters>
                <PivotViewFormatSettings>
                    <PivotViewFormatSetting Name="Amount" Format="C0" UseGrouping=true></PivotViewFormatSetting>
                </PivotViewFormatSettings>
            </PivotViewDataSourceSettings>
            <PivotViewGridSettings AllowSelection="true" ColumnWidth="120">
                <PivotViewSelectionSettings Mode="@Syncfusion.Blazor.PivotView.SelectionMode.Cell" Type="@PivotTableSelectionType.Multiple" CellSelectionMode="PivotCellSelectionMode.Box"></PivotViewSelectionSettings>
            </PivotViewGridSettings>
            <PivotViewCellEditSettings AllowEditing=true AllowAdding=true AllowDeleting=true Mode="EditMode.Normal" AllowEditOnDblClick="true"></PivotViewCellEditSettings>
            <PivotViewEvents TValue="PivotProductDetails" RenameReport="RenameReport" RemoveReport="RemoveReport" SaveReport="SaveReport" LoadReport="LoadReport" FetchReport="FetchReport"></PivotViewEvents>
        </SfPivotView>
    </div>
</div>

<style>
    .e-pivotview {
        min-height: 200px;
    }

    .key-class {
        display: inline-block;
        width: 130px;
    }
</style>

@code{
    private SfPivotView<PivotProductDetails>? Pivot;

    public List<ToolbarItems> PivotToolbar = new List<ToolbarItems>
    {
        ToolbarItems.New,
        ToolbarItems.Save,
        ToolbarItems.SaveAs,
        ToolbarItems.Rename,
        ToolbarItems.Remove,
        ToolbarItems.Load,
        ToolbarItems.Export,
        ToolbarItems.SubTotal,
        ToolbarItems.GrandTotal,
        ToolbarItems.Formatting,
        ToolbarItems.FieldList
    };
    public List<PivotProductDetails>? PivotDataSource { get; set; }
    

    protected override void OnInitialized()
    {
        this.PivotDataSource = PivotProductDetails.GetProductData();
    }

    public string InitReport { get; set; } = string.Empty;
    public string[]? Name { get; set; }
    public List<string> Report = new List<string>();
    public List<string> ReportName = new List<string>();
    public void SaveReport(SaveReportArgs args)
    {
        int i = 0;
        bool IsSaved = false;
        for (i = 0; i < this.ReportName.Count; i++)
        {
            if (this.ReportName[i] == args.ReportName)
            {
                this.Report[i] = args.Report;
                IsSaved = true;
            }
        }
        if (args.Report != null && !(IsSaved))
        {
            this.Report.Add(args.Report);
            this.ReportName.Add(args.ReportName);
        }
    }
    public void FetchReport(FetchReportArgs args)
    {
        args.ReportName = ReportName.ToArray();
    }
    public async Task LoadReport(LoadReportArgs args)
    {
        int i = 0;
        int j = 0;
        for (i = 0; i < ReportName.Count; i++)
        {
            if (ReportName[i] == args.ReportName)
            {
                j = i;
            }
        }
        if(Pivot != null)
        {
            await this.Pivot.LoadPersistDataAsync(Report[j]);
        }
    }
    public async Task RemoveReport(RemoveReportArgs args)
    {
        int i = 0;
        for (i = 0; i < ReportName.Count; i++)
        {
            if (ReportName[i] == args.ReportName)
            {
                ReportName.RemoveAt(i);
                Report.RemoveAt(i);
                break;
            }
        }
        if (Report.Count > 0 && Pivot != null)
        {
            await this.Pivot.LoadPersistDataAsync(Report[0]);
        }
    }
    public void RenameReport(RenameReportArgs args)
    {
        if (args.IsReportExists)
        {
            int j = 0;
            for (j = 0; j < ReportName.Count; j++)
            {
                if (ReportName[j] == args.Rename)
                {
                    ReportName.RemoveAt(j);
                    Report.RemoveAt(j);
                    break;
                }
            }
        }
        int i = 0;
        for (i = 0; i <= (ReportName.Count - 1); i++)
        {
            if (ReportName[i] == args.ReportName)
            {
                ReportName.RemoveAt(i);
                ReportName.Add(args.Rename);
            }
        }
    }
}