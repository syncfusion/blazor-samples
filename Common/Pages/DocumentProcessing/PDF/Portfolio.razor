@page "/pdf/portfolio"
@inject Microsoft.JSInterop.IJSRuntime JS
@using System.IO
@using Syncfusion.Blazor.Buttons
@inject HttpClient Http
@*Hidden:Lines*@
@inherits SampleBaseComponent

@using BlazorDemos.Data.FileFormats.PDF

@*End:Hidden*@
@*Hidden:Lines*@
@inject NavigationManager NavigationManager


@*End:Hidden*@

<SampleDescription>
    <p style="font-size:16px">This sample demonstrates how to create portfolio in the PDF document. You can also extract and remove files from the PDF portfolio. This feature allows the user to bring content together from variety of sources including documents, drawings, images, emails, spreadsheets, and web pages.</p>
</SampleDescription>
<ActionDescription>
  <p style="font-size:16px">More information about the portfolio can be found in this documentation <a target='_blank' href='https://help.syncfusion.com/file-formats/pdf/working-with-portfolio'  aria-label="documentation section">section.</a></p> 
</ActionDescription>

<div class="control-section">
    <p style="font-size:16px">Click the button to view a PDF document generated by Essential PDF. Please note that Adobe Reader or its equivalent is required to view the resultant document. </p>

    <div class="button-section">
        <div id="button-control">
            <div class="row">
                <div>
                    <SfButton @onclick="GeneratePDF">Create Portfolio</SfButton>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .radio-control {
        margin: 0 0 5% 0;
    }

    .control-section .row {
        margin: 10px 0;
    }
</style>

@code {
   
    
    /// <summary>
    /// Create and download the simple PDF document
    ///<summary>
    protected async void GeneratePDF(MouseEventArgs args)
    {	   
        Dictionary<string, MemoryStream> fileData = new Dictionary<string, MemoryStream>();
        string fileDataPath = NavigationManager.BaseUri + SampleService.WebAssetsPath;
        byte[] data = await Http.GetByteArrayAsync(fileDataPath + "data/pdf/corporate-brochure.pdf");
        fileData.Add("corporate-brochure.pdf", new MemoryStream(data));
        data = await Http.GetByteArrayAsync(fileDataPath + "data/pdf/stock.docx");
        fileData.Add("stock.docx", new MemoryStream(data));
        data = await Http.GetByteArrayAsync(fileDataPath + "data/pdf/chart.xlsx");
        fileData.Add("chart.xlsx", new MemoryStream(data));
        PortfolioService service = new PortfolioService(fileData);
        MemoryStream documentStream = service.CreatePdfDocument();
        service.Close();
        await JS.SaveAs("Portfolio.pdf", documentStream.ToArray());
    }
}
