@page "/image-editor/custom-toolbar"
@using Syncfusion.Blazor.ImageEditor
@using Syncfusion.Blazor.Navigations
@using Syncfusion.Blazor.SplitButtons
@using Syncfusion.Blazor.Inputs
@using Syncfusion.Blazor.Buttons
@inject IJSRuntime JSRuntime
@inherits SampleBaseComponent;

<SampleDescription>
    <p>This sample demonstrates a custom toolbar using the Image Editor Control.</p>
</SampleDescription>
<ActionDescription>
    <p>
        The Image Editor component provides built-in support for adding a custom toolbar through APIs in the following ways:
    </p>
    <ul>
        <li><b>Selection</b> : Multiple selection options are available. The selection region can be a square or circle, customized to various aspects ratios, and customized by dragging and resizing.</li>
        <li><b>Crop</b> : The image can be cropped based on the selection.</li>
        <li><b>Rotate</b> : The image can be rotated both clockwise and anticlockwise by 90 degrees.</li>
        <li><b>Freehand drawing</b> : Draw freehand on the image and adjust the pen's stroke color.</li>
        <li><b>Get Image data</b> : Retrieves the edited image in image data format.</li>
        <li><b>Annotation</b> : Text, rectangle, ellipse, and line annotation shapes are supported.</li>
        <li><b>Filters</b> : The predefined filters such as chrome, cold, warm, grayscale, sepia, and invert can be applied to the image.</li>
    </ul>
    <p>
        More information about Image Editor can be found in this
        <a target="_blank" href="https://blazor.syncfusion.com/documentation/image-editor/getting-started/" aria-label="documentation section">
            documentation section
        </a>.
    </p>
</ActionDescription>
<div class="col-lg-12 control-section e-img-editor-sample">
    <div class="customToolbar">
        <div class="header">
            <div class="header-details">
                <div class="header-name">Image Editor</div>
            </div>
        </div>
        <div class="image-preview-container" id="imagePreviewContainer" style="@ImagePrevStyle">
            <img src="@ImageSrc" id="previewImgContainer" class="preview-img-container" alt="previewImage">
            <br>
            <div class="button-container" id="button-container">
                <SfFab id="edit" IconCss="e-icons e-edit" Position="FabPosition.BottomRight" Target=".image-preview-container" IsPrimary=true title="Edit" OnClick="@EditClick" Content="Edit Image"></SfFab>
            </div>
        </div>
        <div class="image-editor-container" id="image-editor-container" style="@ImageEditorStyle">
            <div id="top-toolbarArea">
                <SfToolbar @ref="TopToolbarObj" ID="top-toolbar">
                    <ToolbarEvents Created="TopToolbarCreated" Clicked="ToolbarClicked"></ToolbarEvents>
                    <ToolbarItems>
                        <ToolbarItem Id="cancel" PrefixIcon="e-icons e-close" TooltipText="Cancel" Align="ItemAlign.Center"></ToolbarItem>
                        <ToolbarItem Id="undo" PrefixIcon="e-icons e-undo" TooltipText="Undo" Align="ItemAlign.Center"></ToolbarItem>
                        <ToolbarItem Id="redo" PrefixIcon="e-icons e-redo" TooltipText="Redo" Align="ItemAlign.Center"></ToolbarItem>
                        <ToolbarItem Id="ok" PrefixIcon="@OkBtnIcon" TooltipText="@OkBtnTooltip" Align=ItemAlign.Center></ToolbarItem>
                    </ToolbarItems>
                </SfToolbar>
            </div>
            <SfImageEditor @ref="ImageEditorObj" Toolbar="@Toolbar" ShowQuickAccessToolbar="false">
                <ImageEditorZoomSettings MinZoomFactor="0.1" MaxZoomFactor="50"></ImageEditorZoomSettings>
                <ImageEditorEvents ShapeChanging="ShapeChanging" ShapeChanged="ShapeChanged" Clicked="ImageEditorClicked"></ImageEditorEvents>
            </SfImageEditor>
            <div id="bottom-toolbarArea">
                <div style="@BottomToolbarStyle">
                    <SfToolbar @ref="BottomToolbarObj" ID="bottom-toolbar">
                        <ToolbarEvents Created="BottomToolbarCreated" Clicked="ToolbarClicked"></ToolbarEvents>
                        <ToolbarItems>
                            <ToolbarItem Id="cropAndTransform" PrefixIcon="e-icons e-crop" TooltipText="Crop and Transform" Align="ItemAlign.Center"></ToolbarItem>
                            <ToolbarItem Id="back" PrefixIcon="e-icons e-arrow-left" TooltipText="Back" Align="ItemAlign.Center"></ToolbarItem>
                            <ToolbarItem Id="rotateLeft" PrefixIcon="e-icons e-transform-left" TooltipText="Rotate Left" Align="ItemAlign.Center"></ToolbarItem>
                            <ToolbarItem Id="rotateRight" PrefixIcon="e-icons e-transform-right" TooltipText="Rotate Right" Align="ItemAlign.Center"></ToolbarItem>
                            <ToolbarItem Id="addText" PrefixIcon="e-icons e-text-annotation" TooltipText="Text" Align="ItemAlign.Center"></ToolbarItem>
                            <ToolbarItem Id="fontColor" CssClass="top-icon e-text-font-color e-template" TooltipText="Font Color" Align="ItemAlign.Center" Type="ItemType.Input">
                                <Template>
                                    <SfDropDownButton @ref="FontColorDDBObj" CssClass="e-ie-ddb-popup">
                                        <ChildContent>
                                            <span class="e-btn-icon e-dropdownbtn-preview e-font-color-span" style="background: rgb(255, 255, 255);"></span>
                                            <DropDownButtonEvents Opened='e => DropdownOpened(e, "font-color")'></DropDownButtonEvents>
                                        </ChildContent>
                                        <PopupContent>
                                            <SfColorPicker @ref="FontColorPickerObj" Columns="4" PresetColors="@presetColors" ModeSwitcher="false" NoColor="false" Value="@FontColorValue" Inline="true" ShowButtons="false"
                                                  Mode="ColorPickerMode.Palette" CssClass="e-text-font-color" ValueChange='e => ColorChange(e, "font-color")' OnClose='e => DropDownClose(e, "font-color")'></SfColorPicker>
                                        </PopupContent>
                                    </SfDropDownButton>
                                </Template>
                            </ToolbarItem>
                            <ToolbarItem Id="shapes" PrefixIcon="e-icons e-shapes" TooltipText="Annotations" Align="ItemAlign.Center">
                                <Template>
                                    <SfDropDownButton IconCss="e-icons e-shapes" CssClass="e-image-popup">
                                        <DropDownButtonEvents Opened='e => DropdownOpened(e, "shapes")' ItemSelected='e => DropDownSelected(e, "shapes")'></DropDownButtonEvents>
                                        <DropDownMenuItems>
                                            <DropDownMenuItem Text="Rectangle" Id="rectangle" IconCss="e-icons e-rectangle"></DropDownMenuItem>
                                            <DropDownMenuItem Text="Ellipse" Id="ellipse" IconCss="e-icons e-circle"></DropDownMenuItem>
                                            <DropDownMenuItem Text="Line" Id="line" IconCss="e-icons e-line"></DropDownMenuItem>
                                        </DropDownMenuItems>
                                    </SfDropDownButton>
                                </Template>
                            </ToolbarItem>
                            <ToolbarItem Id="fillColor" PrefixIcon="e-icons e-copy" CssClass="top-icon e-fill e-template" TooltipText="Fill Color" Align="ItemAlign.Center" Type="ItemType.Input">
                                <Template>
                                    <SfDropDownButton @ref="FillColorDDBObj" CssClass="e-ie-ddb-popup">
                                        <ChildContent>
                                            <span class="e-btn-icon e-dropdownbtn-preview e-nocolor-item e-shape-fill-span"></span>
                                            <DropDownButtonEvents Opened='e => DropdownOpened(e, "shape-fill")'></DropDownButtonEvents>
                                        </ChildContent>
                                        <PopupContent>
                                            <SfColorPicker @ref="FillColorPickerObj" Columns="4" PresetColors="@presetColors" ModeSwitcher="false" NoColor="true" Value="@FillColorValue" Inline="true" ShowButtons="false"
                                                Mode="ColorPickerMode.Palette" CssClass="e-shape-fill-color" ValueChange='e => ColorChange(e, "shape-fill")' OnClose='e => DropDownClose(e, "shape-fill")'></SfColorPicker>
                                        </PopupContent>
                                    </SfDropDownButton>
                                </Template>
                            </ToolbarItem>
                            <ToolbarItem Id="strokeColor" PrefixIcon="e-icons e-copy" CssClass="top-icon e-stroke e-template" TooltipText="Stroke Color" Align="ItemAlign.Center" Type="ItemType.Input">
                                <Template>
                                    <SfDropDownButton @ref="StrokeColorDDBObj" CssClass="e-ie-ddb-popup">
                                        <ChildContent>
                                            <span class="e-btn-icon e-dropdownbtn-preview e-shape-stroke-span" style="background: rgb(255, 255, 255);"></span>
                                            <DropDownButtonEvents Opened='e => DropdownOpened(e, "shape-stroke")'></DropDownButtonEvents>
                                        </ChildContent>
                                        <PopupContent>
                                            <SfColorPicker @ref="StrokeColorPickerObj" Columns="4" PresetColors="@presetColors" ModeSwitcher="false" NoColor="false" Value="@StrokeColorValue" Inline="true" ShowButtons="false"
                                                Mode="ColorPickerMode.Palette" CssClass="e-text-font-color" ValueChange='e => ColorChange(e, "shape-stroke")' OnClose='e => DropDownClose(e, "shape-stroke")'></SfColorPicker>
                                        </PopupContent>
                                    </SfDropDownButton>
                                </Template>
                            </ToolbarItem>
                            <ToolbarItem Id="penStrokeColor" PrefixIcon="e-icons e-copy" CssClass="top-icon e-pen-stroke-color e-stroke e-template" TooltipText="stroke Color" Align="ItemAlign.Center" Type="ItemType.Input">
                                <Template>
                                    <SfDropDownButton @ref="PenColorDDBObj" CssClass="e-ie-ddb-popup">
                                        <ChildContent>
                                            <span class="e-btn-icon e-dropdownbtn-preview e-pen-color-span" style="background: rgb(255, 255, 255);"></span>
                                            <DropDownButtonEvents Opened='e => DropdownOpened(e, "pen-color")'></DropDownButtonEvents>
                                        </ChildContent>
                                        <PopupContent>
                                            <SfColorPicker @ref="PenColorPickerObj" Columns="4" ModeSwitcher="false" Value="@PenColorValue" Inline="true" ShowButtons="false" PresetColors="@presetColors"
                                                  Mode="ColorPickerMode.Palette" CssClass="e-pen-color" ValueChange='e => ColorChange(e, "pen-color")' OnClose='e => DropDownClose(e, "pen-color")'></SfColorPicker>
                                        </PopupContent>
                                    </SfDropDownButton>
                                </Template>
                            </ToolbarItem>
                            <ToolbarItem Id="remove" PrefixIcon="e-icons e-trash" TooltipText="Remove" Align="ItemAlign.Center"></ToolbarItem>
                            <ToolbarItem Id="editText" PrefixIcon="e-icons e-annotation-edit" CssClass="top-icon e-annotation-edit" TooltipText="Edit Text" Align="ItemAlign.Center"></ToolbarItem>
                            <ToolbarItem Id="addPen" PrefixIcon="e-icons e-free-pen" TooltipText="Pen" Align="ItemAlign.Center"></ToolbarItem>
                            <ToolbarItem Id="filters" PrefixIcon="e-icons e-filters" TooltipText="Filters" Align="ItemAlign.Center"></ToolbarItem>
                        </ToolbarItems>
                    </SfToolbar>
                </div>
                <div style="@FilterToolbarStyle">
                    <SfToolbar Width="100%" ID="filter-toolbar">
                        <ToolbarEvents Created="FilterToolbarCreated" Clicked="FilterToolbarClicked"></ToolbarEvents>
                        <ToolbarItems>
                            @foreach (var items in filterItems)
                            {
                                <ToolbarItem Id="@items.TooltipText.ToLower()" TooltipText="@items.TooltipText" Align="ItemAlign.Center">
                                    <Template>
                                        <div class="filter-wrapper" style="box-sizing: content-box;">
                                            <canvas id="@items.Id" width="100px" height="100px"></canvas>
                                            <div style="text-align:center;"><span>@items.TooltipText</span></div>
                                        </div>
                                    </Template>
                                </ToolbarItem>
                            }
                        </ToolbarItems>
                    </SfToolbar>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private SfImageEditor ImageEditorObj;
    private SfToolbar TopToolbarObj;
    private SfToolbar BottomToolbarObj;
    private SfDropDownButton FontColorDDBObj;
    private SfDropDownButton FillColorDDBObj;
    private SfDropDownButton StrokeColorDDBObj;
    private SfDropDownButton PenColorDDBObj;
    private SfColorPicker FontColorPickerObj;
    private SfColorPicker FillColorPickerObj;
    private SfColorPicker StrokeColorPickerObj;
    private SfColorPicker PenColorPickerObj;
    private ElementReference? popupElem;
    private List<ImageEditorToolbarItemModel> Toolbar = new List<ImageEditorToolbarItemModel>();
    private bool isShapeCustomizing;
    private bool isTextEditing;
    private bool isShapeSelected;
    private string currentToolbar = "main";
    private string activeObjIndex;
    private ShapeSettings tempShapeSettings;
    private string FontColorValue = "#fff";
    private string FillColorValue = "";
    private string StrokeColorValue = "#fff";
    private string PenColorValue = "#fff";
    private string ImagePrevStyle = "display: block";
    private string ImageEditorStyle = "display: none";
    private string FilterToolbarStyle = "display: none";
    private string BottomToolbarStyle = "display: block";
    private string OkBtnTooltip = "Save";
    private string OkBtnIcon = "e-icons e-save";
    private string ImageSrc = "";
    private bool firstLoad = true;

    private static readonly Dictionary<string, string[]> presetColors = new Dictionary<string, string[]> {
        {
            "Custom", new string[] { "#ffffff", "#000000", "#e91e63", "#9c27b0", "#673ab7", "#2196f3", "#03a9f4", "#00bcd4",
            "#009688", "#8bc34a", "#cddc39", "#ffeb3b" }
        }
    };
    private List<FilterToolbar> filterItems = new List<FilterToolbar> {
        new FilterToolbar { Id = "default_canvas", TooltipText = "Default", Type = ImageFilterOption.Default },
        new FilterToolbar { Id = "chrome_canvas", TooltipText = "Chrome", Type = ImageFilterOption.Chrome },
        new FilterToolbar { Id = "cold_canvas", TooltipText = "Cold", Type = ImageFilterOption.Cold },
        new FilterToolbar { Id = "warm_canvas", TooltipText = "Warm", Type = ImageFilterOption.Warm },
        new FilterToolbar { Id = "grayscale_canvas", TooltipText = "Grayscale", Type = ImageFilterOption.Grayscale },
        new FilterToolbar { Id = "sepia_canvas", TooltipText = "Sepia", Type = ImageFilterOption.Sepia },
        new FilterToolbar { Id = "invert_canvas", TooltipText = "Invert", Type = ImageFilterOption.Invert }
    };
    private string[] filterId = new string[] { "default_canvas", "chrome_canvas", "cold_canvas", "warm_canvas", "grayscale_canvas", "sepia_canvas", "invert_canvas" };
    private string[] toolbars = new string[] { "filter", "rectangle", "ellipse", "line", "text", "edittext", "freehanddraw" };
    private string[] filterValues = new string[] { };
    public class FilterToolbar
    {
        public string Id {get; set;}
        public string TooltipText {get; set;}
        public ImageFilterOption Type { get; set; }
    };

    protected override void OnInitialized()
    {
        ImageSrc = $"{SampleService.WebAssetsPath}images/image-editor/bridge.png";
    }

    private async Task EditClick()
    {
        ImagePrevStyle = "display: none";
        ImageEditorStyle = "display: block";
        await Task.Delay(100);
        await ImageEditorObj.OpenAsync(ImageSrc);
        await ImageEditorObj.RefreshAsync();
        await JSRuntime.InvokeAsync<string>("customToolbarInterop.toolbarPosition");
    }

    private async Task ShapeChanging(ShapeChangeEventArgs args)
    {
        if (args.Action == "select")
        {
            isShapeSelected = true;
            activeObjIndex = args.CurrentShapeSettings.ID;
            if (currentToolbar != args.CurrentShapeSettings.Type.ToString().ToLower())
            { 
                await UpdateToolbar(args, true);
            }
        } 
        else if (args.Action == "insert")
        {
            activeObjIndex = args.CurrentShapeSettings.ID;
            tempShapeSettings = args.CurrentShapeSettings;
        }
    }
    private async void ShapeChanged(ShapeChangedEventArgs args)
    {
        if (args.Action == "apply" && !isShapeCustomizing && !isShapeSelected)
        {
            isTextEditing = false;
            await Task.Delay(100);
            RefreshToolbar("main");
        }
    }
    
    private void ImageEditorClicked()
    {
        if (Array.IndexOf(toolbars, currentToolbar) != -1)
        {
            RefreshToolbar("main");
        }
    }

    private async Task TopToolbarCreated()
    {
        TopToolbarObj.EnableItems(new List<int> { 1, 2 }, false);
        await JSRuntime.InvokeAsync<string>("customToolbarInterop.toolbarPosition");
    }

    private async Task BottomToolbarCreated()
    {
        string[] items = new string[] { "cropAndTransform", "addText", "shapes", "addPen", "filters" };
        for (var i = 0; i < BottomToolbarObj.Items.Count(); i++) {
            if (!items.Contains(BottomToolbarObj.Items[i].Id))
            {
                await BottomToolbarObj.HideItemAsync(i, true);
            } 
        }
        await JSRuntime.InvokeAsync<string>("customToolbarInterop.toolbarPosition");
    }

    private async Task Apply()
    {
        if (currentToolbar == "crop")
        {
            await ImageEditorObj.CropAsync();
        } 
        else if (currentToolbar == "pen") 
        {
            await ImageEditorObj.DisableFreehandDrawAsync();
            ShapeSettings[] shapes = await ImageEditorObj.GetShapesAsync();
            if (activeObjIndex != null && activeObjIndex.Split("_")[0] == "pen")
            {
                tempShapeSettings = shapes.Where(shape => shape.ID == activeObjIndex).FirstOrDefault();
            } 
            else if (shapes.Count() > 0)
            {
                tempShapeSettings = shapes.Last().ID.Split("_")[0] == "pen" ? shapes.Last() : null;
                if (tempShapeSettings != null)
                {
                    await ImageEditorObj.SelectShapeAsync(tempShapeSettings.ID);
                }
            }
            if (tempShapeSettings != null)
            {
                await ImageEditorObj.UpdateShapeAsync(tempShapeSettings);
            }
        } else if (currentToolbar == "freehanddraw" && tempShapeSettings != null)
        {
            await ImageEditorObj.UpdateShapeAsync(tempShapeSettings);
        }
        else if (currentToolbar != "filter" && activeObjIndex != null)
        {
            ShapeSettings[] shapes = await ImageEditorObj.GetShapesAsync();
            tempShapeSettings = shapes.Where(shape => shape.ID == activeObjIndex).FirstOrDefault();
            await ImageEditorObj.UpdateShapeAsync(tempShapeSettings);
        }
        tempShapeSettings = null; activeObjIndex = null;
    }

    private async void ToolbarClicked(Syncfusion.Blazor.Navigations.ClickEventArgs args)
    {
        string item = args.Item.Id.ToLower();
        switch (item) {
            case "back":
                await Apply();
                RefreshToolbar("main");
                break;
            case "cancel":
                isTextEditing = false;
                if (currentToolbar == "main") {
                    ImageEditorStyle = "display: none";
                    ImagePrevStyle = "display: block";
                    await ImageEditorObj.ResetAsync();
                    TopToolbarObj.EnableItems(new List<int> { 1, 2 }, false);
                    StateHasChanged();
                } 
                else
                {
                    if ((isShapeCustomizing || isShapeSelected) && tempShapeSettings != null && tempShapeSettings.ID != null) {
                        await ImageEditorObj.UpdateShapeAsync(tempShapeSettings);
                    }
                    await ImageEditorObj.ClearSelectionAsync(true);
                    RefreshToolbar("main");
                }
                break;
            case "undo":
                isTextEditing = false;
                await ImageEditorObj.UndoAsync();
                RefreshToolbar("main");
                break;
            case "redo":
                isTextEditing = false;
                await ImageEditorObj.RedoAsync();
                RefreshToolbar("main");
                break;
            case "ok":
                isTextEditing = false;
                if (currentToolbar == "main") {
                    ImageSrc = await ImageEditorObj.GetImageDataUrlAsync();
                    await ImageEditorObj.OpenAsync(ImageSrc);
                    ImageEditorStyle = "display: none";
                    ImagePrevStyle = "display: block";
                    TopToolbarObj.EnableItems(new List<int> { 1, 2 }, false);
                    StateHasChanged();
                } 
                else
                {
                    await Apply();
                    RefreshToolbar("main");
                }
                break;
            case "cropandtransform":
                await ImageEditorObj.SelectAsync("custom");
                RefreshToolbar("crop");
                break;
            case "rotateleft":
                await ImageEditorObj.RotateAsync(-90);
                break;
            case "rotateright":
                await ImageEditorObj.RotateAsync(90);
                break;
            case "addtext":
                ImageDimension dimension = await ImageEditorObj.GetImageDimensionAsync();
                await ImageEditorObj.DrawTextAsync((double)(dimension.X + (dimension.Width / 2) - 65), (double)(dimension.Y + (dimension.Height / 2) - 15), "Add Text",
                     "Arial", 30, false, false, "#fff", true);
                isShapeSelected = true;
                await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-font-color-span", "font-color", "#fff");
                FontColorValue = "#fff";
                RefreshToolbar("text");
                break;
            case "remove":
                if (activeObjIndex == null && tempShapeSettings != null && tempShapeSettings.ID != null)
                {
                    activeObjIndex = tempShapeSettings.ID;
                }
                await ImageEditorObj.DeleteShapeAsync(activeObjIndex);
                RefreshToolbar("main");
                break;
            case "edittext":
                isTextEditing = true;
                await ImageEditorObj.EnableTextEditingAsync();
                RefreshToolbar("edittext");
                break;
            case "addpen":
                await ImageEditorObj.EnableFreehandDrawAsync();
                RefreshToolbar("pen");
                break;
            case "filters":
                RefreshToolbar("filter");
                break;
        }
    }

    private async void RefreshToolbar(string type, bool isEvent = false)
    {
        SfToolbar toolbar = BottomToolbarObj;
        string[] items = new string[0]; ImageDimension dimension = new ImageDimension { };
        FilterToolbarStyle = "display: none";
        currentToolbar = type;
        switch (type) {
            case "main":
                items = new string[] { "cropAndTransform", "addText", "shapes", "addPen", "filters" };
                break;
            case "crop":
                items = new string[] { "rotateLeft", "rotateRight" };
                break;
            case "text":
            case "edittext":
                items = new string[] { "back", "fontColor", "remove", "editText" };
                break;
            case "rectangle":
                items = new string[] { "back", "fillColor", "strokeColor", "remove" };
                if (!isEvent) {
                    dimension = await ImageEditorObj.GetImageDimensionAsync();
                    // 100 is half the width of the rectangle
                    // 50 is half the height of the rectangle
                    await ImageEditorObj.DrawRectangleAsync((double)(dimension.X + (dimension.Width / 2)) - 100, (double)(dimension.Y + (dimension.Height / 2) - 50), 200, 100, 2, "#fff", null, 0, true);
                    isShapeSelected = true;
                    await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-shape-fill-span", "shape-fill", "");
                    FillColorValue = ""; StrokeColorValue = "#fff";
                    await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-shape-stroke-span", "stroke-color", "#fff");
                }
                break;
            case "ellipse":
                items = new string[] { "back", "fillColor", "strokeColor", "remove" };
                if (!isEvent) {
                    dimension = await ImageEditorObj.GetImageDimensionAsync();
                    // 100 is half the width of the ellipse
                    // 50 is half the height of the ellipse
                    await ImageEditorObj.DrawEllipseAsync((double)(dimension.X + (dimension.Width / 2) - 100), (double)(dimension.Y + (dimension.Height / 2) - 50), 100, 50, 2, "#fff", null, 0, true);
                    isShapeSelected = true;
                    await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-shape-fill-span", "shape-fill", "");
                    FillColorValue = ""; StrokeColorValue = "#fff";
                    await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-shape-stroke-span", "stroke-color", "#fff");
                }
                break;
            case "line":
                items = new string[] { "back", "strokeColor", "remove" };
                if (!isEvent) {
                    dimension = await ImageEditorObj.GetImageDimensionAsync();
                    if (SampleService.IsDevice)
                    {
                        // 100 is half the width of the line
                        // 50 is half the height of the line
                        await ImageEditorObj.DrawLineAsync((double)(dimension.X + (dimension.Width / 2) - 100), (double)(dimension.Y + (dimension.Height / 2) - 50), (double)(dimension.X + (dimension.Width / 2) + 100), (double)(dimension.Y + (dimension.Height / 2) + 50), 2, "#fff", true);
                    }
                    else
                    {
                        // 200 is half the width of the line
                        // 100 is half the height of the line
                        await ImageEditorObj.DrawLineAsync((double)(dimension.X + (dimension.Width / 2) - 200), (double)(dimension.Y + (dimension.Height / 2) - 100), (double)(dimension.X + (dimension.Width / 2) + 200), (double)(dimension.Y + (dimension.Height / 2) + 100), 2, "#fff", true);
                    }
                    isShapeSelected = true;
                    await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-shape-stroke-span", "stroke-color", "#fff");
                    StrokeColorValue = "#fff";
                }
                break;
            case "pen":
            case "freehanddraw":
                items = new string[] { "back", "penStrokeColor", "remove" };
                break;
            case "filter":
                BottomToolbarStyle = "display: none";
                FilterToolbarStyle = "display: block";
                items = new string[] { "default", "chrome", "cold", "warm", "grayscale", "sepia", "invert" };
                if (firstLoad)
                {
                    string base64 = await ImageEditorObj.GetImageDataUrlAsync();
                    await JSRuntime.InvokeAsync<string>("customToolbarInterop.loadBase64ImageIntoCanvas", filterId, filterValues, base64);
                    firstLoad = false;
                }
                break;
        }
        for (var i = 0; i < toolbar.Items.Count(); i++) {
            if (items.Contains(toolbar.Items[i].Id))
            {
                await toolbar.HideItemAsync(i, false);
            } 
            else 
            {
                await toolbar.HideItemAsync(i, true);
            }
            if (toolbar.Items[i].Id == "remove")
            {
                if (type == "pen") 
                {
                    toolbar.EnableItems(new List<int> {i}, false);
                } 
                else
                {
                    toolbar.EnableItems(new List<int> {i}, true);
                }
            }
        }
        bool enableUndo = await ImageEditorObj.CanUndoAsync();
        bool enableRedo = await ImageEditorObj.CanRedoAsync();
        SfToolbar topToolbar = TopToolbarObj;
        for (var i= 0; i < topToolbar.Items.Count(); i++)
        {
            if (topToolbar.Items[i].Id == "undo") {
                topToolbar.EnableItems(new List<int> {i}, enableUndo);
            }
            else if (topToolbar.Items[i].Id == "redo") {
                topToolbar.EnableItems(new List<int> {i}, enableRedo);
            }
            else if (topToolbar.Items[i].Id == "ok")
            {
                if (currentToolbar == "main")
                {
                    await topToolbar.HideItemAsync(i, false);
                    OkBtnTooltip = "Save";
                    OkBtnIcon = "e-icons e-save";
                } 
                else if (currentToolbar == "crop" || currentToolbar == "filter")
                {
                    await topToolbar.HideItemAsync(i, false);
                    OkBtnTooltip = "Apply";
                    OkBtnIcon = "e-icons e-check-tick";
                }
                else
                {
                    await topToolbar.HideItemAsync(i, true);
                }

            } 
            else if (topToolbar.Items[i].Id == "cancel")
            {
                if (currentToolbar == "main" || currentToolbar == "crop")
                {
                    await topToolbar.HideItemAsync(i, false);
                } 
                else 
                {
                    await topToolbar.HideItemAsync(i, true);
                }
            }
        }
        if (type == "main") { BottomToolbarStyle = "display: block"; }
        StateHasChanged();
        await JSRuntime.InvokeAsync<string>("customToolbarInterop.toolbarPosition");
    }

    private async Task FilterToolbarCreated()
    {
        List<string> filterValue = new List<string> { };
        foreach(var filter in filterItems)
        {
            string filterVal = await ImageEditorObj.GetImageFilterAsync(filter.Type);
            filterValue.Add(filterVal);
        }
        filterValues = filterValue.ToArray();
    }

    private async Task FilterToolbarClicked(Syncfusion.Blazor.Navigations.ClickEventArgs args)
    {
        switch(args.Item.TooltipText)
        {
            case "Default":
                await ImageEditorObj.ApplyImageFilterAsync(ImageFilterOption.Default);
                break;
            case "Chrome":
                await ImageEditorObj.ApplyImageFilterAsync(ImageFilterOption.Chrome);
                break;
            case "Cold":
                await ImageEditorObj.ApplyImageFilterAsync(ImageFilterOption.Cold);
                break;
            case "Warm":
                await ImageEditorObj.ApplyImageFilterAsync(ImageFilterOption.Warm);
                break;
            case "Grayscale":
                await ImageEditorObj.ApplyImageFilterAsync(ImageFilterOption.Grayscale);
                break;
            case "Sepia":
                await ImageEditorObj.ApplyImageFilterAsync(ImageFilterOption.Sepia);
                break;
            case "Invert":
                await ImageEditorObj.ApplyImageFilterAsync(ImageFilterOption.Invert);
                break;
        };
    }

    private async Task UpdateToolbar(ShapeChangeEventArgs args, bool isEvent = false)
    {
        string type = args.CurrentShapeSettings.Type.ToString();
        RefreshToolbar(type.ToLower(), isEvent);
        if (isEvent)
        {
            tempShapeSettings = args.CurrentShapeSettings;
            activeObjIndex = tempShapeSettings.ID;
        }
        if (type == "Rectangle" || type == "Ellipse" || type == "Line" || type == "Pen")
        {
            await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-shape-fill-span", "shape-fill", args.CurrentShapeSettings.FillColor);
            FillColorValue = args.CurrentShapeSettings.FillColor;
            await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-shape-stroke-span", "stroke-color", args.CurrentShapeSettings.StrokeColor);
            StrokeColorValue = args.CurrentShapeSettings.StrokeColor;
        }
        if (type == "Text")
        {
            await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-font-color-span", type, args.CurrentShapeSettings.Color);
            FontColorValue = args.CurrentShapeSettings.Color;
        }
        if (type == "FreehandDraw")
        {
            await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-pen-color-span", type, args.CurrentShapeSettings.StrokeColor);
            StrokeColorValue = args.CurrentShapeSettings.StrokeColor;
        }
    }

    private async Task DropdownOpened(OpenCloseMenuEventArgs args, string type)
    {
        if (type != "shapes")
        {
            popupElem = args.Element;
            await JSRuntime.InvokeAsync<string>("customToolbarInterop.dropdownPosition", args.Element);
        }
    }

    private void DropDownSelected(MenuEventArgs args, string type)
    {
        if (type == "shapes")
        {
            RefreshToolbar(args.Item.Id);
        } 
    }

    private async Task ColorChange(ColorPickerEventArgs args, string type)
    {
        isShapeCustomizing = true;
        if (type == "pen-color")
        {
            PenColorValue = args.CurrentValue.Rgba;
            if (tempShapeSettings != null && tempShapeSettings.ID != null && tempShapeSettings.Type == ShapeType.FreehandDraw) 
            {
                ShapeSettings shapeSetting = new ShapeSettings { ID = tempShapeSettings.ID, Type = ShapeType.FreehandDraw, StartX = tempShapeSettings.StartX,
                    StartY = tempShapeSettings.StartY, StrokeColor = args.CurrentValue.Hex, StrokeWidth = tempShapeSettings.StrokeWidth, 
                    Opacity = tempShapeSettings.Opacity, Points = tempShapeSettings.Points };
                await ImageEditorObj.UpdateShapeAsync(shapeSetting, true);
                tempShapeSettings.StrokeColor = args.CurrentValue.Hex;
                isShapeSelected = true;
            } 
            else 
            {
                ShapeSettings shapeSetting  = new ShapeSettings { ID = null, Type = ShapeType.FreehandDraw, StartX = 0, StartY = 0, StrokeColor = args.CurrentValue.Hex};
                await ImageEditorObj.UpdateShapeAsync(shapeSetting);
            }
        } 
        else 
        {
            ShapeSettings[] shapes = await ImageEditorObj.GetShapesAsync();
            ShapeSettings shapeSetting = shapes.Where(shape => shape.ID == activeObjIndex).FirstOrDefault();
            if (type == "font-color")
            {
                shapeSetting.Color =  FontColorValue = args.CurrentValue.Rgba;
            } 
            else if (type == "shape-fill")
            {
                shapeSetting.FillColor = FillColorValue = args.CurrentValue.Rgba;
            } 
            else if (type == "shape-stroke")
            {
                shapeSetting.StrokeColor = StrokeColorValue = args.CurrentValue.Rgba;
            }
            tempShapeSettings = shapeSetting;
            await ImageEditorObj.UpdateShapeAsync(shapeSetting, true);
            isShapeSelected = true;
            if (isTextEditing)
            {
                await ImageEditorObj.EnableTextEditingAsync();
            }
        }
        isShapeCustomizing = false;
        await JSRuntime.InvokeAsync<string>("customToolbarInterop.updateColorpicker", "e-"+ type +"-span", type, args.CurrentValue.Rgba);
        DropDownClose(null, type);
    }

    private void DropDownClose(BeforeOpenCloseEventArgs args, string type)
    {
        popupElem = null;
        switch(type)
        {
            case "font-color":
                FontColorDDBObj.Toggle();
                break;
            case "shape-fill":
                FillColorDDBObj.Toggle();
                break;
            case "shape-stroke":
                StrokeColorDDBObj.Toggle();
                break;
            case "pen-color":
                PenColorDDBObj.Toggle();
                break;
        }
    }
}
 
@*
// Please refer to the below code snippet for customToolbarInterop.js
window.customToolbarInterop = {
    toolbarPosition: function () {
        setTimeout(() => {
            let toolbarArea = document.getElementById('top-toolbar');
            if (toolbarArea) {
                toolbarArea.style.left = (toolbarArea.parentElement.parentElement.clientWidth / 2) - (toolbarArea.clientWidth / 2) + 'px';
            }
            toolbarArea = document.getElementById('bottom-toolbar');
            if (toolbarArea) {
                toolbarArea.style.left = (toolbarArea.parentElement.parentElement.clientWidth / 2) - (toolbarArea.clientWidth / 2) + 'px';
            }
        }, 20);
    },
    loadBase64ImageIntoCanvas: function (canvasId, filter, base64Url) {
        var canvas = document.getElementById(canvasId);
        var context = canvas.getContext('2d');
        var img = new Image();
        img.onload = function () {
            context.filter = filter;
            context.drawImage(img, 0, 0, canvas.width, canvas.height);
        };
        img.src = base64Url;
    },
    dropdownPosition: function (element) {
        if (window.innerWidth <= 768) {
            var btnElem = document.querySelector('#bottom-toolbar .e-dropdown-btn.e-active');
            if (btnElem) {
                element.style.top = btnElem.getBoundingClientRect().top - element.offsetHeight + 'px';
                element.style.left = element.offsetLeft + 'px';
            }
        }
    },
    updateColorpicker: function (elemId, type, value) {
        var btnElem = document.querySelector(`.e-dropdownbtn-preview.${elemId}`);
        if (type == "shape-fill" && btnElem) {
            if (value == "") {
                btnElem.classList.add('e-nocolor-item');
            } else {
                btnElem.classList.remove('e-nocolor-item');
                btnElem.style.backgroundColor = value;
            }
        } else if (btnElem) {
            btnElem.style.backgroundColor = value;
        }
    }
}
*@

<style>
    .customToolbar .e-image-editor {
        margin: 0 auto;
    }

    .e-img-editor-sample {
        height: 80vh;
        width: 100%;
    }

    .customToolbar {
        height: 100%;
        border: 1px solid #D9D9D9;
        border-radius: 10px;
    }

    .button-container {
        display: flex;
        left: calc(50% - 26px);
        position: absolute;
        bottom: 20px;
    }

    .image-preview-container {
        height: calc(100% - 40px);
        text-align: center;
        position: relative;
    }

    .preview-img-container {
        max-width: 100%;
        max-height: 100%;
        padding: 20px;
        margin: 0 auto;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .customToolbar .e-image-editor {
        border: none !important;
    }

    .image-editor-container {
        height: calc(100% - 40px);
        position: relative;
    }

    .image-editor-container .e-image-editor {
        height: 100% !important;
    }

    #top-toolbarArea {
        position: absolute;
        top: 20px;
        z-index: 1;
    }

    #top-toolbar {
        border-radius: 8px;
    }

    #bottom-toolbarArea {
        position: absolute;
        bottom: 70px;
        z-index: 1;
        width: 100% !important;
    }

    #bottom-toolbar {
        position: absolute;
        border-radius: 8px;
    }

    #filter-toolbar {
        height: 130px !important;
        top: 50px;
    }

    .button-container button:hover, .message button:hover{
        color: #fff;
        cursor: pointer;
    }

    .custom-button { 
        padding: 8px; 
        margin: 10px; 
        background: #6750a4 !important; 
        color: #fff; 
        border: none; 
        border-radius: 50%; 
        cursor: pointer; 
    }

    .customToolbar .e-toolbar .e-toolbar-items .e-dropdown-btn .e-caret-hide {
        display: none !important; /* stylelint-disable-line declaration-no-important */
    }

    .customToolbar .e-dropdown-btn, 
    .customToolbar .e-dropdown-btn.e-btn {
        box-shadow: none;
        background-color: rgba(184, 184, 184, 0.9584);
        background: inherit;
    }

    .customToolbar .e-toolbar .e-toolbar-items .e-dropdown-btn:hover {
        background: rgba(0, 0, 0, 0.12);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.87);
    }
    .customToolbar .e-toolbar .e-toolbar-items .e-dropdown-btn:focus {
        background: rgba(0, 0, 0, 0.18);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.87);
    }
    .customToolbar .e-toolbar .e-toolbar-items .e-dropdown-btn:active {
        background: rgba(184, 184, 184, 0.9584);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.87);
    }
    .customToolbar .e-toolbar .e-toolbar-items .e-colorpicker-wrapper.e-shape-fill-color .e-split-btn-wrapper .e-split-btn .e-selected-color,
    .customToolbar .e-image-editor .e-toolbar .e-toolbar-items .e-colorpicker-wrapper.e-shape-stroke-color .e-split-btn-wrapper .e-split-btn .e-selected-color,
    .customToolbar .e-image-editor .e-toolbar .e-toolbar-items .e-colorpicker-wrapper.e-text-stroke-color .e-split-btn-wrapper .e-split-btn .e-selected-color,
    .customToolbar .e-image-editor .e-toolbar .e-toolbar-items .e-colorpicker-wrapper.e-pen-stroke-color .e-split-btn-wrapper .e-split-btn .e-selected-color {
        background: none;
        border-bottom-style: solid;
        border-bottom-width: 3px;
        width: 14px;
        margin: 0 2px;
        border-bottom-color: #000;
    }
    .customToolbar .e-toolbar .e-toolbar-items .e-colorpicker-wrapper.e-shape-fill-color .e-split-btn-wrapper .e-split-btn .e-selected-color .e-split-preview,
    .customToolbar .e-image-editor .e-toolbar .e-toolbar-items .e-colorpicker-wrapper.e-shape-stroke-color .e-split-btn-wrapper .e-split-btn .e-selected-color .e-split-preview,
    .customToolbar .e-image-editor .e-toolbar .e-toolbar-items .e-colorpicker-wrapper.e-text-stroke-color .e-split-btn-wrapper .e-split-btn .e-selected-color .e-split-preview,
    .customToolbar .e-image-editor .e-toolbar .e-toolbar-items .e-colorpicker-wrapper.e-pen-stroke-color .e-split-btn-wrapper .e-split-btn .e-selected-color .e-split-preview {
        display: none;
    }

    .customToolbar .e-nocolor-item {
        background: transparent url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNnB4IiBoZWlnaHQ9IjZweCIgdmlld0JveD0iMCAwIDYgNiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTAgKDU0OTgzKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5Hcm91cCA5PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+PC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikdyb3VwLTkiPgogICAgICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlLTExIiBmaWxsPSIjRTBFMEUwIiB4PSIwIiB5PSIwIiB3aWR0aD0iMyIgaGVpZ2h0PSIzIj48L3JlY3Q+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUtMTEtQ29weS0yIiBmaWxsPSIjRkZGRkZGIiB4PSIwIiB5PSIzIiB3aWR0aD0iMyIgaGVpZ2h0PSIzIj48L3JlY3Q+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUtMTEtQ29weSIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iMCIgd2lkdGg9IjMiIGhlaWdodD0iMyI+PC9yZWN0PgogICAgICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlLTExLUNvcHktMyIgZmlsbD0iI0UwRTBFMCIgeD0iMyIgeT0iMyIgd2lkdGg9IjMiIGhlaWdodD0iMyI+PC9yZWN0PgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+") !important; /* stylelint-disable-line declaration-no-important */
        background-size: 8px !important; /* stylelint-disable-line declaration-no-important */
    }

    .customToolbar .e-bigger .e-toolbar .e-toolbar-items .e-btn-icon.e-dropdownbtn-preview,
        .e-bigger .e-toolbar .e-toolbar-items .e-btn-icon.e-dropdownbtn-preview {
        margin-top: -3px !important; /* stylelint-disable-line declaration-no-important */
        margin-left: -1px;
    }

    .customToolbar .e-toolbar .e-toolbar-items .e-btn-icon.e-dropdownbtn-preview {
        height: 18px;
        width: 18px;
        margin-top: -4px !important; /* stylelint-disable-line declaration-no-important */
        margin-left: -1px;
    }

    .customToolbar .e-fill.e-template .e-caret::before {
        content: "\e783" !important;
    }

    .customToolbar .e-stroke.e-template .e-caret::before, .e-text-font-color.e-template .e-caret::before, .e-pen-stroke-color.e-template .e-caret::before {
        content: "\e739" !important;
        font-size: 14px !important;
    }

    .customToolbar .e-folder-open {
        border: none !important;
        font-size: 18px !important;
    }

    .customToolbar .e-btn .e-btn-icon.e-icon-left {
        margin-left: 0px !important;
    }

    .customToolbar .e-dropdown-popup ul #calibri {
        font-family: 'Calibri';
    }

    #edit {
        background-color: #6750a4 !important;
    }

    .header {
        max-width: 100%;
        background-color: #6750a4;
        padding: 10px; 
        border-radius: 10px 10px 0 0;  
        word-wrap: break-word; 
        align-items: center; 
    }

    .header-name {
        color: #fff;
    }

     .customToolbar .e-free-pen::before {
        content: "\e7db";
    }

    .e-btn.e-selected-btn {
        background: #bdbdbd !important;
    }

    .fluent .customToolbar .e-dropdown-btn, .e-dropdown-btn.e-btn,
    .fluent .customToolbar .e-toolbar .e-toolbar-item .e-tbar-btn:hover,
    .fluent .customToolbar .e-toolbar .e-toolbar-item .e-tbar-btn:focus,
    .fluent-dark .customToolbar .e-dropdown-btn, .e-dropdown-btn.e-btn,
    .fluent-dark .customToolbar .e-toolbar .e-toolbar-item .e-tbar-btn:hover,
    .fluent-dark .customToolbar .e-toolbar .e-toolbar-item .e-tbar-btn:focus {
        border: none !important;
    }

    .bootstrap5\.3-dark .customToolbar #edit,
    .fluent2-highcontrast .customToolbar #edit,
    .fabric-dark .customToolbar #edit,
    .highcontrast .customToolbar #edit,
    .bootstrap5-dark .customToolbar #edit,
    .fluent-dark .customToolbar #edit,
    .tailwind-dark .customToolbar #edit,
    .material-dark .customToolbar #edit,
    .material3-dark .customToolbar #edit,
    .bootstrap-dark .customToolbar #edit {
        color: #fff;
    }

    .fluent-dark .customToolbar .e-toolbar .e-toolbar-items .e-dropdown-btn:focus,
    .fluent-dark .customToolbar .e-toolbar .e-toolbar-items .e-dropdown-btn:hover,
    .fluent-dark .customToolbar  .e-toolbar .e-toolbar-item .e-tbar-btn .e-icons,
    .fluent-dark .customToolbar .e-toolbar .e-toolbar-items .e-dropdown-btn {
        color: #fff;
    }

    .material .customToolbar #edit,
    .material-dark .customToolbar #edit {
        text-transform: capitalize;
    }

    .fluent .customToolbar .e-toolbar .e-toolbar-item .e-tbar-btn:focus,
    .fluent-dark .customToolbar .e-toolbar .e-toolbar-item .e-tbar-btn:focus {
        box-shadow: none !important;
    }
    
    .bootstrap5 .customToolbar .e-toolbar-item.e-template .e-dropdown-btn {
        color: #6c757d !important;
    }
    
    .bootstrap4 .customToolbar .e-toolbar-item.e-template .e-dropdown-btn {
        color: rgb(73, 80, 87) !important;
    }
    
    .fabric-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .fabric-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .fluent-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .fluent-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .bootstrap5\.3-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .bootstrap5\.3-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .fluent2-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .fluent2-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .material-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .material-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .fluent2-highcontrast .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .fluent2-highcontrast .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .bootstrap-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .bootstrap-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .bootstrap5-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .bootstrap5-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .material3-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .material3-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .tailwind-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .tailwind-dark .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus,
    .highcontrast .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:hover,
    .highcontrast .customToolbar .e-toolbar-item.e-template .e-dropdown-btn:focus {
        color: #fff !important;
    }
    
    .highcontrast .customToolbar .e-free-pen::before {
        content: "\e739";
    }

    .highcontrast .customToolbar .e-toolbar-item.e-template .e-dropdown-btn.e-btn.e-active {
        color: #fff !important;
    }
    
    .material .customToolbar .e-free-pen::before,
    .material-dark .customToolbar .e-free-pen::before,
    .fabric .customToolbar .e-free-pen::before,
    .fabric-dark .customToolbar .e-free-pen::before {
        content: "\e737";
    }
    
    .bootstrap .customToolbar .e-free-pen::before,
    .bootstrap-dark .customToolbar .e-free-pen::before {
        content: "\e767";
    }
    
    .bootstrap4 .customToolbar .e-free-pen::before {
        content: "\e756";
    }

    .bootstrap5 .customToolbar .e-fill.e-template .e-caret::before,
    .bootstrap-dark .customToolbar .e-fill.e-template .e-caret::before,
    .bootstrap5 .customToolbar .e-stroke.e-template .e-caret::before,
    .bootstrap-dark .customToolbar .e-stroke.e-template .e-caret::before,
    .bootstrap5 .customToolbar .e-text-font-color.e-template .e-caret::before,
    .bootstrap-dark .customToolbar .e-text-font-color.e-template .e-caret::before {
        font-size: 14px;
    }
    
    .material .customToolbar .e-fill.e-template .e-caret::before,
    .material-dark .customToolbar .e-fill.e-template .e-caret::before,
    .fabric .customToolbar .e-fill.e-template .e-caret::before,
    .fabric-dark .customToolbar .e-fill.e-template .e-caret::before,
    .bootstrap .customToolbar .e-fill.e-template .e-caret::before,
    .bootstrap-dark .customToolbar .e-fill.e-template .e-caret::before,
    .highcontrast .customToolbar .e-fill.e-template .e-caret::before {
        content: "\e35c" !important;
        font-size: 14px;
    }

    .material .customToolbar .e-stroke.e-template .e-caret::before,
    .material-dark .customToolbar .e-stroke.e-template .e-caret::before,
    .material .customToolbar .e-text-font-color.e-template .e-caret::before,
    .material-dark .customToolbar .e-text-font-color.e-template .e-caret::before {
        content: "\ec15";
        font-size: 14px;
    }
    
    .fabric .customToolbar .e-stroke.e-template .e-caret::before,
    .fabric-dark .customToolbar .e-stroke.e-template .e-caret::before,
    .fabric .customToolbar .e-text-font-color.e-template .e-caret::before,
    .fabric-dark .customToolbar .e-text-font-color.e-template .e-caret::before {
        content: "\ebee";
        font-size: 14px;
    }
    
    .bootstrap .customToolbar .e-stroke.e-template .e-caret::before,
    .bootstrap-dark .customToolbar .e-stroke.e-template .e-caret::before,
    .bootstrap .customToolbar .e-text-font-color.e-template .e-caret::before,
    .bootstrap-dark .customToolbar .e-text-font-color.e-template .e-caret::before {
        content: "\ebc6" !important;
        font-size: 14px !important;
    }

    .highcontrast .customToolbar .e-stroke.e-template .e-caret::before,
    .highcontrast .customToolbar .e-text-font-color.e-template .e-caret::before {
        content: "\eb6e" !important;
        font-size: 14px !important;
    }

    @@media only screen and (max-width: 700px) {
        .customToolbar #filter-toolbar {
            overflow: scroll;
        }
    }

    .fluent2 .customToolbar .e-toolbar .e-toolbar-items.e-tbar-pos .e-toolbar-center {
        margin: 0 4px !important; /* stylelint-disable-line declaration-no-important */
    }
    
    .fluent2 .customToolbar .e-toolbar {
	    border: 1px solid #808080 !important; /* stylelint-disable-line declaration-no-important */
    }
</style>