@page "/gantt-chart/exporting"

@using Syncfusion.Blazor.Gantt
@using Syncfusion.Blazor.Navigations
@using BlazorDemos.Pages.GanttChart.Data

@*Hidden:Lines*@
@inject SampleService SampleService
@implements IDisposable
@*End:Hidden*@

<ActionDescription>
    <p>
        This sample demonstrates client side exporting in the <a class="e-gantt-exporting-reference-link" aria-label="Navigate to the explore Syncfusion Blazor Gantt Chart component"
                                                                 href="https://www.syncfusion.com/blazor-components/blazor-gantt-chart"
                                                                 target="_blank" rel="noopener">Blazor Gantt Chart</a>,
        enabling the current project view to be saved as Excel, CSV, or PDF with a single toolbar interaction.
    </p>

    <p>
        The built in toolbar buttons raise the
        <a class="e-gantt-exporting-reference-link" aria-label="Navigate to the OnToolbarClick event reference in Gantt events"
           href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.Gantt.GanttEvents-1.html#Syncfusion_Blazor_Gantt_GanttEvents_1_OnToolbarClick"
           target="_blank" rel="noopener">OnToolbarClick</a>
        event, where the chart invokes the asynchronous export APIs:
    </p>
    <ul>
        <li>
            <a aria-label="Navigate to the ExportToExcelAsync method reference for the Gantt chart component"
               href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.Gantt.SfGantt-1.html#Syncfusion_Blazor_Gantt_SfGantt_1_ExportToExcelAsync"
               target="_blank" rel="noopener">ExportToExcelAsync</a>
            � generates a workbook that preserves the grid hierarchy, timeline, and task metadata.
        </li>
        <li>
            <a aria-label="Navigate to the ExportToCsvAsync method reference for the Gantt chart component"
               href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.Gantt.SfGantt-1.html#Syncfusion_Blazor_Gantt_SfGantt_1_ExportToCsvAsync"
               target="_blank" rel="noopener">ExportToCsvAsync</a>
            � produces a delimited text file for downstream analytics.
        </li>
        <li>
            <a aria-label="Navigate to the ExportToPdfAsync method reference for the Gantt chart component"
               href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.Gantt.SfGantt-1.html#Syncfusion_Blazor_Gantt_SfGantt_1_ExportToPdfAsync_Syncfusion_Blazor_Gantt_GanttPdfExportProperties_"
               target="_blank" rel="noopener">ExportToPdfAsync</a>
            � renders a paginated report using <a aria-label="Navigate to the GanttPdfExportProperties for the Gantt chart component"
                                                  href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.Gantt.GanttPdfExportProperties.html"
                                                  target="_blank" rel="noopener">GanttPdfExportProperties</a> for fine tuned layout control.
        </li>
    </ul>

    <p>
        These exports operate on the same data source configured for the interactive chart, ensuring that filtering, sorting, and hierarchy selections carry over to the generated files. 
    </p>
    <p>
        Additionally the toolbar provides Zooming operations, enabling interactive task management.
    </p>
    <p>
        For further details, refer to the
        <a class="e-gantt-exporting-reference-link" aria-label="Navigate to the documentation for Excel export in the Gantt chart component"
           href="https://blazor.syncfusion.com/documentation/gantt-chart/excel-export"
           target="_blank" rel="noopener">documentation</a>.
    </p>
</ActionDescription>

<div class="control-section e-gantt-exporting-sample">
	<SfGantt @ref="GanttChartInstance" ID="GanttExport" DataSource="@TaskCollection" Height="450px" AllowPdfExport="true" Width="100%"
			 HighlightWeekends="true" Toolbar="ToolbarItems" AllowExcelExport="true" AllowSelection="true"
			 GridLines="GridLine.Both" TreeColumnIndex="1" ProjectStartDate="@(new DateTime(2025, 3, 25))" ProjectEndDate="@(new DateTime(2025, 9, 01))" ScrollToTaskbarOnClick="true">
		<GanttTaskFields Id="TaskId" Name="TaskName" StartDate="StartDate" EndDate="EndDate" Progress="Progress"
						 Dependency="Predecessor" ParentID="ParentId"></GanttTaskFields>
		<GanttColumns>
			<GanttColumn Field="TaskId" Width="100"></GanttColumn>
			<GanttColumn Field="TaskName" HeaderText="Task Name" Width="250" ClipMode="Syncfusion.Blazor.Grids.ClipMode.EllipsisWithTooltip"></GanttColumn>
			<GanttColumn Field="StartDate" HeaderText="Start Date"></GanttColumn>
			<GanttColumn Field="EndDate" HeaderText="End Date"></GanttColumn>
			<GanttColumn Field="Progress" HeaderText="Progress"></GanttColumn>
			<GanttColumn Field="Predecessor" HeaderText="Dependency"></GanttColumn>
		</GanttColumns>
		<GanttLabelSettings LeftLabel="TaskName" TaskLabel="Progress" TValue="GanttData.TaskData"></GanttLabelSettings>
		<GanttSplitterSettings ColumnIndex="2"></GanttSplitterSettings>
		<GanttEvents OnToolbarClick="HandleToolbarClick" TValue=GanttData.TaskData></GanttEvents>
		<GanttTimelineSettings>
			<GanttTopTierSettings Unit="TimelineViewMode.Week" Format="MMM dd, y"></GanttTopTierSettings>
			<GanttBottomTierSettings Unit="TimelineViewMode.Day"></GanttBottomTierSettings>
		</GanttTimelineSettings>
	</SfGantt>
</div>
@code {

    /// <summary>
    /// Initializes the Default Exporting sample with Gantt task data.
    /// </summary>
    protected override void OnInitialized()
    {
        TaskCollection = GanttData.EditingData();
        @*Hidden:Lines*@
        SampleService.TouchMousePreferenceChanged += OnTouchMousePreferenceChanged;
        @*End:Hidden*@
    }
    @*Hidden:Lines*@
    private async void OnTouchMousePreferenceChanged()
    {
        await GanttChartInstance.RefreshAsync();
        await GanttChartInstance.CallStateHasChangedAsync();
    }

    public void Dispose()
    {
        SampleService.TouchMousePreferenceChanged -= OnTouchMousePreferenceChanged;
    }
    @*End:Hidden*@
}
<style>
	.container-fluid {
		padding: 0px !important;
	}

	.e-gantt-exporting-sample {
		padding: 20px;
	}

    .e-gantt-exporting-reference-link {
        text-decoration: none !important;
    }

    .e-gantt-exporting-reference-link:hover,
    .e-gantt-exporting-reference-link:focus {
         text-decoration: underline !important;
    }
</style>