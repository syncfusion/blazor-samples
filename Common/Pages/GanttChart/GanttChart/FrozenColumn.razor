@page "/gantt-chart/frozen-column"

@using Syncfusion.Blazor.Gantt
@using Syncfusion.Blazor.Grids
@using Syncfusion.Blazor.Navigations
@using Syncfusion.Blazor.DropDowns
@using ej2_blazor_ganttdata

@*Hidden:Lines*@
@inherits SampleBaseComponent
@*End:Hidden*@

<SampleDescription>
    <p>This sample demonstrates the frozen columns feature of the Gantt Chart. Scroll the movable content horizontally on the grid side to view the frozen columns with the content.</p>
</SampleDescription>
<ActionDescription>
    <p>You can add or remove frozen columns dynamically by dragging and dropping the column freeze line separator to the desired column or programmatically changing the freeze direction, as shown in the sample above. 
    The freezing feature allows users to freeze specific columns in either the right or left direction, enabling them to scroll through the grid's remaining movable content. This can be accomplished by setting the Gantt Column <a aria-label="Navigate to the freeze property reference for gantt column" target="_blank" href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.Gantt.GanttColumn.html#Syncfusion_Blazor_Gantt_GanttColumn_Freeze">Freeze</a> property.
    </p>
    <p>
        For more details, refer to the
        <a aria-label="Navigate to the documentation for the Frozen column in gantt chart component" target="_blank" href="https://blazor.syncfusion.com/documentation/gantt-chart/frozen-columns">
            documentation section.
        </a>
    </p>
</ActionDescription>

<div class="col-lg-12 control-section">
    <div class="content-wrapper">
        <div class="row">
            <SfGantt @ref="Gantt" DataSource="@TaskList" Height="450px" Width="100%" HighlightWeekends="true"
                     Toolbar="@toolbarItems"
                     AllowSelection="true" GridLines="Syncfusion.Blazor.Gantt.GridLine.Both"
                     TreeColumnIndex="1" ProjectStartDate="@ProjectStartDate" ProjectEndDate="@ProjectEndDate"
                     FrozenColumns="@FrozenColumnCount" ScrollToTaskbarOnClick="true">
                <GanttTaskFields Id="TaskId" Name="TaskName" StartDate="StartDate" EndDate="EndDate" Duration="Duration"
                                 Progress="Progress" Dependency="Predecessor" ParentID="ParentId"></GanttTaskFields>
                <GanttColumns>
                    <GanttColumn Field="TaskId" HeaderText="Task ID" Width="100" Visible="false"></GanttColumn>
                    <GanttColumn Field="TaskName" HeaderText="Job Name" MinWidth="250"
                                 ClipMode="Syncfusion.Blazor.Grids.ClipMode.EllipsisWithTooltip" IsFrozen="@IsTaskNameFrozen" Freeze="@TaskNameFreezeDirection"></GanttColumn>
                    <GanttColumn Field="StartDate" HeaderText="Start Date" Width="180" IsFrozen="@IsStartDateFrozen" Freeze="@StartDateFreezeDirection"></GanttColumn>
                    <GanttColumn Field="EndDate" HeaderText="End Date" Width="180"></GanttColumn>
                    <GanttColumn Field="Duration" HeaderText="Duration" Width="180" IsFrozen="@IsDurationFrozen" Freeze="@DurationFreezeDirection"></GanttColumn>
                    <GanttColumn Field="Progress" HeaderText="Progress" Width="150" IsFrozen="@IsProgressFrozen" Freeze="@ProgressFreezeDirection"></GanttColumn>
                    <GanttColumn Field="Predecessor" HeaderText="Dependency" Width="150" IsFrozen="@IsDependencyFrozen" Freeze="@DependencyFreezeDirection"></GanttColumn>
                </GanttColumns>
                <GanttLabelSettings LeftLabel="TaskName" TaskLabel="Progress" TValue="GanttData.TaskData"></GanttLabelSettings>
                <GanttSplitterSettings Position="90%"></GanttSplitterSettings>
            </SfGantt>
        </div>
    </div>
</div>

@code {
    private SfGantt<GanttData.TaskData>? Gantt;
    private DateTime ProjectStartDate { get; set; } = new DateTime(2025, 3, 25);
    private DateTime ProjectEndDate { get; set; } = new DateTime(2025, 9, 01);
    private List<GanttData.TaskData> TaskList { get; set; } = new List<GanttData.TaskData>();
    private int FrozenColumnCount { get; set; } = 1;

    private bool IsTaskNameFrozen { get; set; } = true;
    private FreezeDirection TaskNameFreezeDirection { get; set; } = FreezeDirection.Left;

    private bool IsStartDateFrozen { get; set; } = false;
    private FreezeDirection StartDateFreezeDirection { get; set; }

    private bool IsDurationFrozen { get; set; } = false;
    private FreezeDirection DurationFreezeDirection { get; set; }

    private bool IsProgressFrozen { get; set; } = true;
    private FreezeDirection ProgressFreezeDirection { get; set; } = FreezeDirection.Right;

    private bool IsDependencyFrozen { get; set; } = true;
    private FreezeDirection DependencyFreezeDirection { get; set; } = FreezeDirection.Right;

    private static readonly List<string> RightFrozenColumns = new List<string> { "Duration", "Progress", "Dependency" };
    private static readonly List<string> LeftFrozenColumns = new List<string> { "Job Name", "Start Date" };

    private string SelectedLeftColumn { get; set; } = LeftFrozenColumns[0];
    private string SelectedRightColumn { get; set; } = RightFrozenColumns[1];
    private List<Object> toolbarItems;
    protected override void OnInitialized()
    {
        TaskList = GanttData.EditingData().ToList();
        toolbarItems = new List<Object>
        {
            new ItemModel
            {
                Id = "LeftFrozenLabel",
                Template = (RenderFragment)(builder =>
                {
                    builder.OpenElement(0, "label");
                    builder.AddAttribute(1, "class", "showhide");
                    builder.AddContent(2, "Left Frozen Column");
                    builder.CloseElement();
                })
            },
            new ItemModel
            {
                Id = "LeftFrozenDropdown",
                Template = (RenderFragment)(builder =>
                {
                    builder.OpenComponent<SfDropDownList<string, string>>(0);
                    builder.AddAttribute(1, "Width", "125px");
                    builder.AddAttribute(2, "DataSource", LeftFrozenColumns);
                    builder.AddAttribute(3, "Value", SelectedLeftColumn);
                    builder.AddAttribute(4, "ValueChanged", EventCallback.Factory.Create<string>(this, v => SelectedLeftColumn = v));
                    builder.AddAttribute(5, "ChildContent", (RenderFragment)(childBuilder =>
                    {
                        childBuilder.OpenComponent<DropDownListEvents<string, string>>(0);
                        childBuilder.AddAttribute(1, "ValueChange", EventCallback.Factory.Create<ChangeEventArgs<string, string>>(this, OnLeftFreezeChange));
                        childBuilder.CloseComponent();
                    }));
                    builder.CloseComponent();
                })
            },
            new ItemModel
            {
                Id = "RightFrozenLabel",
                Template = (RenderFragment)(builder =>
                {
                    builder.OpenElement(0, "label");
                    builder.AddAttribute(1, "class", "showhide");
                    builder.AddContent(2, "Right Frozen Column");
                    builder.CloseElement();
                })
            },
            new ItemModel
            {
                Id = "RightFrozenDropdown",
                Template = (RenderFragment)(builder =>
                {
                    builder.OpenComponent<SfDropDownList<string, string>>(0);
                    builder.AddAttribute(1, "Width", "142px");
                    builder.AddAttribute(2, "DataSource", RightFrozenColumns);
                    builder.AddAttribute(3, "Value", SelectedRightColumn);
                    builder.AddAttribute(4, "ValueChanged", EventCallback.Factory.Create<string>(this, v => SelectedRightColumn = v));
                    builder.AddAttribute(5, "ChildContent", (RenderFragment)(childBuilder =>
                    {
                        childBuilder.OpenComponent<DropDownListEvents<string, string>>(0);
                        childBuilder.AddAttribute(1, "ValueChange", EventCallback.Factory.Create<ChangeEventArgs<string, string>>(this, OnRightFreezeChange));
                        childBuilder.CloseComponent();
                    }));
                    builder.CloseComponent();
                })
            }
        };

    }

    public async void OnRightFreezeChange(Syncfusion.Blazor.DropDowns.ChangeEventArgs<string, string> args)
    {
        switch (args.Value)
        {
            case "Dependency":
                IsDependencyFrozen = true;
                IsProgressFrozen = false;
                IsDurationFrozen = false;
                break;
            case "Progress":
                IsDependencyFrozen = true;
                IsProgressFrozen = true;
                IsDurationFrozen = false;
                break;
            default:
                IsDependencyFrozen = true;
                IsProgressFrozen = true;
                IsDurationFrozen = true;
                DurationFreezeDirection = FreezeDirection.Right;
                break;
        }
        await Gantt.RefreshAsync();
    }

    public async void OnLeftFreezeChange(Syncfusion.Blazor.DropDowns.ChangeEventArgs<string, string> args)
    {
        if (args.Value == "Job Name")
        {
            IsTaskNameFrozen = true;
            IsStartDateFrozen = false;
        }
        else
        {
            IsTaskNameFrozen = true;
            IsStartDateFrozen = true;
            StartDateFreezeDirection = FreezeDirection.Left;
        }
        await Gantt.RefreshAsync();
    }

}
<style>
   
    .showhide {
        font-size: 14px;
        font-weight: 400;
        padding: 10px 15px 10px 10px;
        margin-bottom: 0px;
    }

    .e-switch-control {
        display: flex;
        align-items: center;
    }

    .e-mastertext {
        font-size: 15px;
        font-family: Roboto;
        font-weight: bolder;
        opacity: 0.87;
        padding: 0.7em;
    }

    .e-bigger .showhide {
        font-size: 16px;
        padding: 10px 15px 10px 10px
    }
    </style>
