@page "/gantt-chart/context-menu"

@using Syncfusion.Blazor.Gantt
@using BlazorDemos.Pages.GanttChart.Data

@*Hidden:Lines*@
@inject SampleService SampleService
@implements IDisposable
@*End:Hidden*@

<SampleDescription>
    <p>
		This sample demonstrates the context menu feature in the <a class="e-gantt-contextmenu-reference-link" aria-label="Navigate to the explore Syncfusion Blazor Gantt Chart component"
                                                                    href="https://www.syncfusion.com/blazor-components/blazor-gantt-chart"
                                                                    target="_blank">Blazor Gantt Chart</a>, which enables quick actions by right clicking anywhere within the chart or grid area.
    </p>
    <p>
		The default context menu items are rendered by setting the <a class="e-gantt-contextmenu-reference-link" aria-label="Navigate to the Enable Context Menu property reference in gantt chart component" target='_blank' href='https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.Gantt.SfGantt-1.html#Syncfusion_Blazor_Gantt_SfGantt_1_EnableContextMenu'>EnableContextMenu</a> property to <code>true</code>.
    </p>
    <p>
        When right clicking on the grid header, the following options are available:
    </p>
    <ul>
        <li><code>AutoFitAll</code> - Auto fit all columns.</li>
        <li><code>AutoFit</code> - Auto fit the current column.</li>
        <li><code>SortAscending </code> - Sort the current column in ascending order.</li>
        <li><code>SortDescending </code> - Sort the current column in descending order.</li>
    </ul>
    <p>When right clicking on the grid or chart content, the following options are available:</p>
    <ul>
        <li><code>TaskInformation</code> - Edit the current record.</li>
        <li><code>DeleteTask</code> - Delete the current record.</li>
        <li><code>Save</code> - Save changes (visible during edit mode).</li>
        <li><code>Cancel</code> - Cancel changes (visible during edit mode).</li>
        <li><code>DeleteDependency </code> - Delete the dependency of the current record.</li>
        <li><code>Convert </code> - Convert the normal task into a milestone task and vice versa.</li>
        <li>
            <code>Add</code>
            <ul>
                <li><code>Above</code> - Add a new row above the selected row </li>
                <li><code>Below</code> - Add a new row below the selected row</li>
                <li><code>Child</code> - Add a new row as a child to the selected row</li>
                <li><code>Milestone</code> - Add a milestone task below to the selected row</li>
            </ul>
        </li>
    </ul>
    <p>
		Both default and custom context menu items can be configured using the <a class="e-gantt-contextmenu-reference-link" aria-label="Navigate to the ContextMenuItems property reference for gantt chart component" target='_blank' href='https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.Gantt.SfGantt-1.html#Syncfusion_Blazor_Gantt_SfGantt_1_ContextMenuItems'>ContextMenuItems</a> property.
    </p>
    <p>
        The toolbar provides built-in options for add, update, delete, expand, and collapse operations, enabling interactive task management.
    </p>
    <p>
		For further details, refer to the <a class="e-gantt-contextmenu-reference-link" aria-label="Navigate to the documentation for context menu in gantt chart component" target='_blank' href='https://blazor.syncfusion.com/documentation/gantt-chart/context-menu'>documentation</a>.
    </p>
</SampleDescription>

<div class="control-section e-gantt-contextmenu-sample">
	<SfGantt @ref="GanttInstance" EnableContextMenu="true" DataSource="@TaskCollection" Height="450px" Width="100%" HighlightWeekends="true"
			 Toolbar="@(new List<string>(){ "Add", "Edit", "Update", "Delete", "Cancel", "ExpandAll", "CollapseAll"})"
			 AllowSorting="true" AllowResizing="true" AllowSelection="true"
			 GridLines="GridLine.Both" TreeColumnIndex="1"
			 ProjectStartDate="@(new DateTime(2025, 3, 25))" ProjectEndDate="@(new DateTime(2025, 9, 01))" ScrollToTaskbarOnClick="true">
		<GanttTaskFields Id="TaskId" Name="TaskName" StartDate="StartDate" EndDate="EndDate"
						 Duration="Duration" Progress="Progress" Dependency="Predecessor"
						 ParentID="ParentId" Notes="Notes">
		</GanttTaskFields>
		<GanttColumns>
			<GanttColumn Field="TaskId" Width="100"></GanttColumn>
			<GanttColumn Field="TaskName" Width="250"
						 ClipMode="Syncfusion.Blazor.Grids.ClipMode.EllipsisWithTooltip"></GanttColumn>
			<GanttColumn Field="StartDate" HeaderText="Start Date" MinWidth="120"></GanttColumn>
			<GanttColumn Field="EndDate" HeaderText="End Date" MinWidth="120"></GanttColumn>
			<GanttColumn Field="Duration" HeaderText="Duration" MinWidth="120"></GanttColumn>
			<GanttColumn Field="Progress" HeaderText="Progress" MinWidth="120"></GanttColumn>
			<GanttColumn Field="Predecessor" HeaderText="Dependency" MinWidth="200"></GanttColumn>
			<GanttColumn Field="Notes" Width="100"></GanttColumn>
		</GanttColumns>
		<GanttEditSettings AllowAdding="true" AllowEditing="true" AllowDeleting="true"
						   AllowTaskbarEditing="true" ShowDeleteConfirmDialog="true">
		</GanttEditSettings>
		<GanttLabelSettings LeftLabel="TaskName" TaskLabel="Progress" TValue="GanttData.TaskData"></GanttLabelSettings>
		<GanttSplitterSettings Position="40%"></GanttSplitterSettings>
		<GanttEvents TValue="GanttData.TaskData" RowCreating="HandleRowCreating"></GanttEvents>
	</SfGantt>
</div>

@code {
	public SfGantt<GanttData.TaskData>? GanttInstance { get; set; }
	public List<GanttData.TaskData> TaskCollection { get; set; } = new List<GanttData.TaskData>();

	/// <summary>
	/// Initializes the Context Menu sample with editable Gantt task data.
	/// </summary>
	protected override void OnInitialized()
	{
		TaskCollection = GanttData.EditingData();
		@*Hidden:Lines*@
		SampleService.TouchMousePreferenceChanged += OnTouchMousePreferenceChanged;
		@*End:Hidden*@
	}

	/// <summary>
	/// Handles the row creation event in the Gantt Chart and sets a default task name when a new row is added.
	/// </summary>
	private void HandleRowCreating(GanttRowCreatingEventArgs<GanttData.TaskData> args)
	{
		args.Data.TaskName = "New Task " + args.Data.TaskId;
	}

	@*Hidden:Lines*@
	private async void OnTouchMousePreferenceChanged()
	{
		await GanttInstance.RefreshAsync();
		await GanttInstance.CallStateHasChangedAsync();
	}

	public void Dispose()
	{
		SampleService.TouchMousePreferenceChanged -= OnTouchMousePreferenceChanged;
	}
	@*End:Hidden*@
}
<style>
	.container-fluid {
		padding: 0px !important;
	}

	.e-gantt-contextmenu-sample {
		padding: 20px;
	}

	.e-gantt-contextmenu-reference-link {
		text-decoration: none !important;
	}

	.e-gantt-contextmenu-reference-link:hover,
	.e-gantt-contextmenu-reference-link:focus {
		text-decoration: underline !important;
	}
</style>