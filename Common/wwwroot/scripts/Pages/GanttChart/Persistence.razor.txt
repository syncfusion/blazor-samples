@page "/gantt-chart/persistence"

@using Syncfusion.Blazor.Gantt
@using Syncfusion.Blazor.Navigations
@using BlazorDemos.Pages.GanttChart.Data

@inject IJSRuntime JsInterop
@*Hidden:Lines*@
@inject SampleService SampleService
@implements IDisposable
@*End:Hidden*@

<ActionDescription>
    <p>
		This sample demonstrates the state management feature in the <a class="e-gantt-persistence-reference-link" aria-label="Navigate to the explore Syncfusion Blazor Gantt Chart component"
                                                                        href="https://www.syncfusion.com/blazor-components/blazor-gantt-chart"
                                                                        target="_blank" rel="noopener">Blazor Gantt Chart</a>. It allows saving the current chart configuration in the browser’s local storage so that settings are retained even after refreshing the page.
    </p>
    <p>
        In this example, the Gantt Chart state is saved, reset, and reloaded to demonstrate how state management works. The chart can be refreshed to its original configuration or loaded with a previously saved state from the browser’s local storage.
    </p>
    <p>The following Gantt areas are persisted:</p>
    <ul>
        <li><strong>Grid</strong>: Sorting, filtering, column state (resize, reorder, show/hide), searching, and TreeColumnIndex.</li>
        <li><strong>Splitter</strong>: Splitter position and collapsible state.</li>
        <li><strong>Chart</strong>: Time span and zooming level.</li>
    </ul>
    <p>
        This feature helps maintain a consistent experience across sessions by preserving layout and configuration preferences.
    </p>
    <p>
        Additionally the toolbar provides the zooming operations, enabling interactive task management.
    </p>
    <p>
		For further details, refer to the <a class="e-gantt-persistence-reference-link" aria-label="Navigate to the documentation for state management in gantt chart component" target="_blank" rel="noopener" href="https://blazor.syncfusion.com/documentation/gantt-chart/state-management">documentation</a>.
    </p>
</ActionDescription>

<div class="control-section e-gantt-persistance-sample">
	<SfGantt ID="Persist" @ref="GanttInstance" DataSource="@TaskCollection" Height="450px" Width="100%"
			 ProjectStartDate="@(new DateTime(2021, 03, 25))" ProjectEndDate="@(new DateTime(2021, 07, 17))"
			 Toolbar="ToolbarItems" AllowReordering="true" AllowFiltering="true"
			 AllowSorting="true" AllowResizing="true" ShowColumnMenu="true"
			 EnablePersistence="true" ScrollToTaskbarOnClick="true">
		<GanttTaskFields Id="TaskId" Name="TaskName" StartDate="StartDate"
						 EndDate="EndDate" Duration="Duration" Progress="Progress"
						 Dependency="Predecessor" ParentID="ParentId">
		</GanttTaskFields>
		<GanttLabelSettings LeftLabel="TaskName" TValue="DefaultData.TaskData">
		</GanttLabelSettings>
		<GanttEvents OnToolbarClick="HandleToolbarClick" TValue="DefaultData.TaskData"></GanttEvents>
	</SfGantt>
</div>
@code{
	/// <summary>
	/// Initializes the Persistence sample with default Gantt task data.
	/// </summary>
	protected override void OnInitialized()
	{
		TaskCollection = DefaultData.ProjectNewData();
		@*Hidden:Lines*@
		SampleService.TouchMousePreferenceChanged += OnTouchMousePreferenceChanged;
		@*End:Hidden*@
	}
	@*Hidden:Lines*@
	private async void OnTouchMousePreferenceChanged()
	{
		await GanttInstance.RefreshAsync();
		await GanttInstance.CallStateHasChangedAsync();
	}

	public void Dispose()
	{
		SampleService.TouchMousePreferenceChanged -= OnTouchMousePreferenceChanged;
	}
	@*End:Hidden*@
}
<style>
	.container-fluid {
		padding: 0px !important;
	}

	.e-gantt-persistance-sample {
		padding: 20px;
	}

		.e-gantt-persistance-sample .bootstrap4 .e-savestate::before {
			content: '\e74d';
		}

		.e-gantt-persistance-sample .bootstrap4 .e-setstate::before {
			content: '\e75d';
		}

		.e-gantt-persistance-sample .bootstrap4 .e-reloadpage::before {
			content: '\e716';
		}

	.bootstrap5\.3 .e-savestate::before,
	.bootstrap5\.3-dark .e-savestate::before,
	.bootstrap5 .e-savestate::before,
	.bootstrap5-dark .e-savestate::before,
	.tailwind3 .e-savestate::before,
	.fluent .e-savestate::before,
	.fluent-dark .e-savestate::before,
	.tailwind3-dark .e-savestate::before,
	.material3 .e-savestate::before,
	.material3-dark .e-savestate::before,
	.fluent2 .e-savestate::before,
	.fluent2-dark .e-savestate::before,
	.fluent2-highcontrast .e-savestate::before {
		content: '\e7c8';
	}

	.bootstrap5\.3 .e-setstate::before,
	.bootstrap5\.3-dark .e-setstate::before,
	.bootstrap5 .e-setstate::before,
	.bootstrap5-dark .e-setstate::before,
	.tailwind3-dark .e-setstate::before,
	.tailwind3 .e-setstate::before,
	.fluent .e-setstate::before,
	.fluent-dark .e-setstate::before,
	.material3 .e-setstate::before,
	.material3-dark .e-setstate::before,
	.fluent2 .e-setstate::before,
	.fluent2-dark .e-setstate::before,
	.fluent2-highcontrast .e-setstate::before {
		content: '\e7a1';
	}

	.bootstrap5\.3 .e-reloadpage::before,
	.bootstrap5\.3-dark .e-reloadpage::before,
	.bootstrap5 .e-reloadpage::before,
	.bootstrap5-dark .e-reloadpage::before,
	.tailwind3-dark .e-reloadpage::before,
	.tailwind3 .e-reloadpage::before,
	.fluent .e-reloadpage::before,
	.fluent-dark .e-reloadpage::before,
	.material3 .e-reloadpage::before,
	.material3-dark .e-reloadpage::before,
	.fluent2 .e-reloadpage::before,
	.fluent2-dark .e-reloadpage::before,
	.fluent2-highcontrast .e-reloadpage::before {
		content: '\e706';
	}

	.e-gantt-persistance-sample .bootstrap .e-savestate::before,
	.e-gantt-persistance-sample .bootstrap-dark .e-savestate::before {
		content: '\e701';
	}

	.e-gantt-persistance-sample .bootstrap .e-setstate::before,
	.e-gantt-persistance-sample .bootstrap-dark .e-setstate::before {
		content: '\ec32';
	}

	.e-gantt-persistance-sample .bootstrap .e-reloadpage::before,
	.e-gantt-persistance-sample .bootstrap-dark .e-reloadpage::before {
		content: '\e975';
	}

	.fabric .e-savestate::before,
	.fabric-dark .e-savestate::before,
	.highcontrast .e-savestate::before {
		content: '\e700';
	}

	.e-gantt-persistance-sample .fabric .e-setstate::before {
		content: '\ebe4';
	}

	.e-gantt-persistance-sample .fabric .e-reloadpage::before,
	.e-gantt-persistance-sample .fabric-dark .e-reloadpage::before {
		content: '\e218';
	}

	.highcontrast .e-setstate::before,
	.fabric-dark .e-setstate::before {
		content: '\e603';
	}

	.e-gantt-persistance-sample .highcontrast .e-reloadpage::before {
		content: '\e837';
	}

	.e-gantt-persistance-sample .material .e-savestate::before,
	.e-gantt-persistance-sample .material-dark .e-savestate::before {
		content: '\e735';
	}

	.e-gantt-persistance-sample .material .e-setstate::before,
	.e-gantt-persistance-sample .material-dark .e-setstate::before {
		content: '\ec0b';
	}

	.e-gantt-persistance-sample .material .e-reloadpage::before,
	.e-gantt-persistance-sample .material-dark .e-reloadpage::before {
		content: '\e99d';
	}

	.bootstrap5\.3 .e-resetstate::before,
	.bootstrap5\.3-dark .e-resetstate::before,
	.bootstrap5 .e-resetstate::before,
	.bootstrap5-dark .e-resetstate::before,
	.tailwind3-dark .e-resetstate::before,
	.tailwind3 .e-resetstate::before,
	.fluent .e-resetstate::before,
	.fluent-dark .e-resetstate::before,
	.material3 .e-resetstate::before,
	.material3-dark .e-resetstate::before,
	.fluent2 .e-resetstate::before,
	.fluent2-dark .e-resetstate::before,
	.fluent2-highcontrast .e-resetstate::before {
		content: '\e89b';
	}

	.material .e-resetstate::before,
	.material-dark .e-resetstate::before,
	.bootstrap .e-resetstate::before,
	.bootstrap-dark .e-resetstate::before,
	.bootstrap4 .e-resetstate::before {
		content: '\e953';
	}

	.fabric .e-resetstate::before,
	.fabric-dark .e-resetstate::before,
	.highcontrast .e-resetstate::before {
		content: '\e948';
	}

	.e-gantt-persistence-reference-link {
		text-decoration: none !important;
	}

	.e-gantt-persistence-reference-link:hover,
	.e-gantt-persistence-reference-link:focus {
		text-decoration: underline !important;
	}
</style>