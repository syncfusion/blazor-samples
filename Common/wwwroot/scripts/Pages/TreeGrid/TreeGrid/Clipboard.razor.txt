@page "/tree-grid/clipboard"

@using Syncfusion.Blazor.Grids
@using Syncfusion.Blazor.TreeGrid
@using Syncfusion.Blazor.Navigations
@*Hidden:Lines*@
@using TaskData
@inherits SampleBaseComponent;
@*End:Hidden*@

@{
    List<ItemModel> Toolbar = new List<ItemModel>();
    Toolbar.Add(new ItemModel { Text = "Copy", TooltipText = "Copy", PrefixIcon = "e-copy", Id = "copy" });
    Toolbar.Add(new ItemModel { Text = "Copy With Header", TooltipText = "Copy With Header", PrefixIcon = "e-copy", Id = "copyHeader" });
}

<ActionDescription>
<p>
    This sample demonstrates clipboard copy, allowing selected rows or cells to be copied with or without headers using toolbar commands or keyboard shortcuts.
  </p>
  <p>
    Invoke copy programmatically via <a target="_blank" rel="noopener" aria-label="Navigate to the CopyAsync method reference for the Tree Grid component" href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.TreeGrid.SfTreeGrid-1.html#Syncfusion_Blazor_TreeGrid_SfTreeGrid_1_CopyAsync_System_Nullable_System_Boolean__">CopyAsync</a>. Shortcuts: <strong>Ctrl+C</strong> (without headers) and <strong>Ctrl+Shift+H</strong> (with headers). Toolbar buttons <strong>Copy</strong> and <strong>Copy With Header</strong> are also provided. Multi-row selection is configured with <a target="_blank" rel="noopener" aria-label="Navigate to the TreeGridSelectionSettings.Type property reference" href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.TreeGrid.TreeGridSelectionSettings.html#Syncfusion_Blazor_TreeGrid_TreeGridSelectionSettings_Type">TreeGridSelectionSettings.Type</a> = <code>Multiple</code>.
  </p>
  <p>
    See the <a target="_blank" rel="noopener" href="https://blazor.syncfusion.com/documentation/treegrid/clipboard/" aria-label="Navigate to documentation for clipboard in the Tree Grid component">clipboard documentation</a> for more options.
  </p>
</ActionDescription>



<div class="col-lg-12 control-section">
    <div class="content-wrapper">
        <div class="row">
             <SfTreeGrid @ref="@TreeGridInstance" Toolbar="Toolbar" Height="312" DataSource="@TreeData" IdMapping="TaskID" AllowPaging="true" ParentIdMapping="ParentID" TreeColumnIndex="1">
                <TreeGridEvents TValue="TaskData" OnToolbarClick="HandleToolbarClick"></TreeGridEvents>
                <TreeGridSelectionSettings Type="SelectionType.Multiple"></TreeGridSelectionSettings>
                <TreeGridPageSettings PageSize="20" PageSizeMode="PageSizeMode.All"></TreeGridPageSettings>
                <TreeGridColumns>
                    <TreeGridColumn Field="TaskID" HeaderText="Task ID" Width="80" TextAlign="TextAlign.Right"></TreeGridColumn>
                    <TreeGridColumn Field="TaskName" HeaderText="Task Name" Width="175" ClipMode="ClipMode.EllipsisWithTooltip"></TreeGridColumn>
                    <TreeGridColumn Field="AssignedTo" HeaderText="Assignee" Width="120" TextAlign="TextAlign.Left"></TreeGridColumn>
                    <TreeGridColumn Field="Priority" HeaderText="Priority" Width="100"></TreeGridColumn>
                    <TreeGridColumn Field="Progress" HeaderText="Status" Width="90"></TreeGridColumn>
                    <TreeGridColumn Field="StartDate" HeaderText="Start Date" Format="d" Type=ColumnType.Date Width="110" TextAlign="TextAlign.Right"></TreeGridColumn>
                    <TreeGridColumn Field="Duration" HeaderText="Duration (In Days)" Width="120" ClipMode="ClipMode.EllipsisWithTooltip" TextAlign="TextAlign.Right"></TreeGridColumn>
                </TreeGridColumns>
            </SfTreeGrid>
        </div>
    </div>
</div>

@code{
    SfTreeGrid<TaskData> TreeGridInstance { get; set; } = null!;

    private List<TaskData> TreeData { get; set; } = new List<TaskData>();
    
    protected override void OnInitialized()
    {
        TreeData = TaskData.GetTree().ToList();
    }

    public async void HandleToolbarClick(Syncfusion.Blazor.Navigations.ClickEventArgs args)
    {
        var selectedTasks = await TreeGridInstance.GetSelectedRecordsAsync();
        if (selectedTasks.Any())
        {
            bool includeHeader = args.Item.Id == "copyHeader";
            await TreeGridInstance.CopyAsync(includeHeader);
        }
    }
}
