@page "/linear-gauge/container"

@using Syncfusion.Blazor
@using Syncfusion.Blazor.LinearGauge
@using Syncfusion.Blazor.DropDowns
@using Syncfusion.Blazor.Popups;
@*Hidden:Lines*@
@using ThemeHelper
@*End:Hidden*@
@inject NavigationManager NavigationManager
@*Hidden:Lines*@
@inherits SampleBaseComponent
@*End:Hidden*@

<ActionDescription>
<p>
    This sample displays different container types—normal, thermometer, and rounded rectangle—and allows changing the gauge orientation between vertical and horizontal.
  </p>
  <p>
    Select an orientation from the <strong>Orientation</strong> dropdown to render the Linear Gauge vertically or horizontally. Choose the container type from the <strong>Container Type</strong> dropdown.
  </p>
  <p>
    Learn more about containers in the <a target="_blank" rel="noopener" href="https://blazor.syncfusion.com/documentation/linear-gauge/linear-gauge-appearance#customizing-the-linear-gauge-container" aria-label="Blazor Linear Gauge Custom Container documentation">container customization</a> section and about orientation in the <a target="_blank" rel="noopener" href="https://blazor.syncfusion.com/documentation/linear-gauge/axis#orientation" aria-label="Blazor Linear Gauge Axis Orientation documentation">axis orientation</a> section of the documentation.
  </p>
</ActionDescription>

<style>
    tr {
        height: 40px;
    }

    td {
        width: 50%
    }

    .name {
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>

<div class="col-lg-8 control-section">
    <SfLinearGauge @ref='LinearGaugue' Title="Temparature Measure" Orientation="@GaugeOrientation" Theme="@Theme" Background="transparent">
        <LinearGaugeTitleStyle FontFamily="inherit"></LinearGaugeTitleStyle>
        <LinearGaugeContainer Width="13" RoundedCornerRadius="5" Type="@GaugeContainerType">
            <LinearGaugeContainerBorder Width="1"></LinearGaugeContainerBorder>
            <LinearGaugeAxes>
                <LinearGaugeAxis Minimum="0" Maximum="180">
                    <LinearGaugeLine Width="0" />
                    <LinearGaugeMajorTicks Color="#9e9e9e" Interval="20" Height="20" />
                    <LinearGaugeMinorTicks Color="#9e9e9e" Interval="10" Height="10" />
                    <LinearGaugeAxisLabelStyle>
                        <LinearGaugeAxisLabelFont FontFamily="inherit"></LinearGaugeAxisLabelFont>
                    </LinearGaugeAxisLabelStyle>
                    <LinearGaugePointers>
                        <LinearGaugePointer PointerValue="90" Height="13" Width="13" Type="Point.Bar" Color="#f02828" />
                    </LinearGaugePointers>
                </LinearGaugeAxis>
                <LinearGaugeAxis Minimum="0" Maximum="180" OpposedPosition="true">
                    <LinearGaugeLine Width="0" />
                    <LinearGaugeMajorTicks Color="#9e9e9e" Interval="20" Height="20" />
                    <LinearGaugeMinorTicks Color="#9e9e9e" Interval="10" Height="10" />
                    <LinearGaugeAxisLabelStyle>
                        <LinearGaugeAxisLabelFont FontFamily="inherit"></LinearGaugeAxisLabelFont>
                    </LinearGaugeAxisLabelStyle>
                    <LinearGaugePointers>
                        <LinearGaugePointer Width="0" />
                    </LinearGaugePointers>
                </LinearGaugeAxis>
            </LinearGaugeAxes>
        </LinearGaugeContainer>
    </SfLinearGauge>
</div>
<PropertyPanel ControlSecClass="col-lg-8" CollapseChanged="HandlePanelCollapseChangedAsync" InitialRefresh="HandlePanelCollapseChangedAsync">
            <table class="full-width-element">
                <tbody>
                    <tr>
                        <td>
                            <div>Orientation</div>
                        </td>
                        <td>
                            <div class="full-width-element">
                                <SfDropDownList TValue="string" TItem="OrientationData" DataSource="@GaugeOrientData" @bind-Value="@OrientationValue">
                                    <DropDownListEvents TValue="string" TItem="OrientationData" ValueChange="OrintationChange" />
                                    <DropDownListFieldSettings text="Name" value="Name" />
                                </SfDropDownList>
                            </div>
                        </td>
                    </tr>
                    <br />
                    <tr>
                        <td>
                            <div>Container Type</div>
                        </td>
                        <td>
                            <div class="full-width-element">
                                <SfTooltip @ref="DropdownTooltip" ID="Tooltip" Target=".e-list-item .name[title]"></SfTooltip>
                                <SfDropDownList TValue="string" TItem="ContainerTypeData" DataSource="@ContainerTypeDatas" @bind-Value="@ContainerTypeValue">
                                    <DropDownListEvents TValue="string" TItem="ContainerTypeData" ValueChange="ContainerTypeChange" Opened="OnOpen" OnClose="OnClose" />
                                    <DropDownListFieldSettings text="Name" value="Name" />
                                    <DropDownListTemplates TItem="ContainerTypeData">
                                        <ItemTemplate>
                                            <div class="name" title="@((context as ContainerTypeData).Name)"> @((context as ContainerTypeData).Name) </div>
                                        </ItemTemplate>
                                    </DropDownListTemplates>
                                </SfDropDownList>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
</PropertyPanel>

<style>
    .full-width-element {
        width: 100%;
    }
</style>

@code {
    public SfLinearGauge? LinearGaugue;
    public SfTooltip? DropdownTooltip;
    public bool IsOpen { get; set; }
    public Theme Theme { get; set; }
    public Orientation GaugeOrientation = Orientation.Vertical;
    public ContainerType GaugeContainerType = ContainerType.Thermometer;
    public string OrientationValue = "Vertical";
    public string ContainerTypeValue = "Thermometer";

    public List<OrientationData> GaugeOrientData = new List<OrientationData>
    {
        new OrientationData { Name = "Vertical" },
        new OrientationData { Name = "Horizontal" },
    };

    public List<ContainerTypeData> ContainerTypeDatas = new List<ContainerTypeData>
    {
        new ContainerTypeData { Name = "Thermometer" },
        new ContainerTypeData { Name = "Normal" },
        new ContainerTypeData { Name = "Rounded Rectangle" },
    };

    private void OrintationChange(ChangeEventArgs<string, OrientationData> args)
    {
        OrientationValue = (args?.Value)?.ToString() ?? OrientationValue;
        GaugeOrientation = this.OrientationValue == "Vertical" ? Orientation.Vertical : Orientation.Horizontal;
    }

    private void ContainerTypeChange(ChangeEventArgs<string, ContainerTypeData> args)
    {
        ContainerTypeValue = (args?.Value)?.ToString() ?? ContainerTypeValue;
        if (ContainerTypeValue == "Thermometer")
            GaugeContainerType = ContainerType.Thermometer;
        else if (ContainerTypeValue == "Normal")
            GaugeContainerType = ContainerType.Normal;
        else
            GaugeContainerType = ContainerType.RoundedRectangle;
    }

    public void OnOpen(PopupEventArgs args)
    {
        IsOpen = true;
    }

    public void OnClose(PopupEventArgs args)
    {
        DropdownTooltip?.CloseAsync();
    }

    protected override async Task OnInitializedAsync()
    {
        Theme = ThemeHelper.GetCurrentTheme(NavigationManager.Uri);
        if (IsOpen && DropdownTooltip != null)
        {
            await DropdownTooltip.RefreshAsync();
        }
    }
    public class OrientationData
    {
        public string? Name { get; set; }
    }

    public class ContainerTypeData
    {
        public string? Name { get; set; }
    }

    /// <summary>
    /// EventCallback handler - invoked when PropertyPanel is expanded/collapsed
    /// This is triggered by CollapseChanged EventCallback from PropertyPanel
    /// </summary>
    public async Task HandlePanelCollapseChangedAsync()
    {

        if (LinearGaugue != null)
        {
            await LinearGaugue.RefreshAsync();
        }
    }
}
