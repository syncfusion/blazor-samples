@page "/DropDown-List/Data-Binding"

@using System.Collections.ObjectModel;
@using Syncfusion.Blazor.DropDowns
@using Syncfusion.Blazor.Data
@using System.Dynamic

@*Hidden:Lines*@
@inherits SampleBaseComponent
@*End:Hidden*@

<ActionDescription>
<p>This example demonstrates DropDownList's comprehensive data binding support with remote and local data sources.</p>

<p>Data binding features:</p>
<ul>
  <li>Select items by clicking DropDownList component</li>
  <li>Loader icon appears during remote data retrieval initially</li>
  <li>Supported data types: Array, ObservableCollection, ExpandoObject, DynamicObject, DataManager</li>
</ul>

<p>DataManager configuration:</p>
<ul>
  <li><a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.DataManager.html#Syncfusion_Blazor_DataManager_Url" target="_blank" rel="noopener" aria-label="Navigate to Url property">DataManager.Url</a> - Service endpoint for data retrieval</li>
  <li><a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.DataManager.html#Syncfusion_Blazor_DataManager_Adaptor" target="_blank" rel="noopener" aria-label="Navigate to Adaptor property">DataManager.Adaptor</a> - ODataAdaptor (default) or alternative adaptors</li>
</ul>

<p>Adaptor options:</p>
<ul>
  <li><code>UrlAdaptor</code> - For any remote services</li>
  <li><code>ODataAdaptor</code> - For OData endpoints</li>
  <li><code>ODataV4Adaptor</code> - For OData V4 endpoints</li>
  <li><code>WebApiAdaptor</code> - For Web API services</li>
  <li><code>WebMethodAdaptor</code> - For web methods</li>
</ul>

<p>Data binding types in this sample:</p>
<ul>
  <li>Local Data - Sports collection</li>
  <li>Remote Data - Customer data via DataManager</li>
  <li>Observable Collection - Colors data</li>
  <li>ExpandObject - Vehicles data</li>
  <li>DynamicObject - Customers data</li>
</ul>

<p><b>See also</b></p>
<ul>
  <li><a href="https://blazor.syncfusion.com/documentation/dropdown-list/data-binding/" target="_blank" rel="noopener" aria-label="Navigate to Blazor DropDownList Data Binding documentation">Blazor DropDownList - Data Binding</a></li>
  <li><a href="https://blazor.syncfusion.com/documentation/data/getting-started" target="_blank" rel="noopener" aria-label="Navigate to Blazor Data Manager documentation">Blazor Data Manager</a></li>
</ul>
</ActionDescription>


<div class="control-section col-lg-12">
    <div class="row">
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">Local Data</label>
                <SfDropDownList TValue="string" TItem="GameFields" PopupHeight="230px" Placeholder="Select a game" DataSource="@Games" @bind-Value="@GameValue">
                    <DropDownListFieldSettings Text="Text" Value="Id"/>
                </SfDropDownList>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">Remote Data</label>
                <SfDropDownList TValue="string" TItem="OrderDetails" PopupHeight="230px" Placeholder="Select a name" Query="@RemoteDataQuery" @bind-Value="@OrderValue">
                    <SfDataManager Url="https://blazor.syncfusion.com/services/production/api/Orders" CrossDomain="true" Adaptor="Syncfusion.Blazor.Adaptors.WebApiAdaptor" />
                    <DropDownListFieldSettings Text="CustomerId" Value="CustomerId"/>
                </SfDropDownList>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">Observable Collection</label>
                <SfDropDownList  TValue="string" TItem="Colors" PopupHeight="230px" Placeholder="Select a color" DataSource="@ColorsData" @bind-Value="@ColorValue">
                    <DropDownListFieldSettings Text="Color" Value="Code"/>
                </SfDropDownList>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">ExpandoObject</label>
                <SfDropDownList TItem="ExpandoObject" TValue="string" PopupHeight="230px" Placeholder="Select a vehicle" DataSource="@VehicleData" @bind-Value="@VehicleValue">
                    <DropDownListFieldSettings Text="Text" Value="Id"></DropDownListFieldSettings>
                </SfDropDownList>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">DynamicObject</label>
                <SfDropDownList TValue="string" TItem="DynamicDictionary" Placeholder="Select a name" DataSource="@Orders" @bind-Value="@DropValue">
                    <DropDownListFieldSettings Text="CustomerName" Value="CustomerName"/>
                </SfDropDownList>
            </div>
        </div>
    </div>
</div>

@code{
    public string GameValue { get; set; } = "Game3";
    public string OrderValue { get; set; } = "ANTON";
    public string ColorValue { get; set; } = "#75523C";
    public string VehicleValue { get; set; } = "1011";
    public string DropValue { get; set; } = "Michael";
    
    public class GameFields
    {
        public string? Id { get; set; }
        public string? Text { get; set; }
    }

    public List<GameFields> Games = new List<GameFields>()
    {
        new GameFields() { Id = "Game1", Text = "American Football" },
        new GameFields() { Id = "Game2", Text = "Badminton" },
        new GameFields() { Id = "Game3", Text = "Basketball" },
        new GameFields() { Id = "Game4", Text = "Cricket" },
        new GameFields() { Id = "Game5", Text = "Football" },
        new GameFields() { Id = "Game6", Text = "Golf" },
        new GameFields() { Id = "Game7", Text = "Hockey" },
        new GameFields() { Id = "Game8", Text = "Rugby" },
        new GameFields() { Id = "Game9", Text = "Snooker" },
        new GameFields() { Id = "Game10", Text = "Tennis" }
    };

    public Query RemoteDataQuery = new Query().Select(new List<string> { "CustomerId" }).Take(6).RequiresCount();
    public class OrderDetails
    {
        public int? OrderId { get; set; }
        public string? CustomerId { get; set; }
        public int? EmployeeId { get; set; }
        public double? Freight { get; set; }
        public string? ShipCity { get; set; }
        public bool Verified { get; set; }
        public DateTime? OrderDate { get; set; }
        public string? ShipName { get; set; }
        public string? ShipCountry { get; set; }
        public DateTime? ShippedDate { get; set; }
        public string? ShipAddress { get; set; }
    }

    public class Colors
    {
        public string? Code { get; set; }
        public string? Color { get; set; }
    }

    private ObservableCollection<Colors> ColorsData = new ObservableCollection<Colors>() 
    {
        new Colors() { Color = "Chocolate", Code = "#75523C" }, 
        new Colors() { Color = "Cadet Blue", Code = "#3B8289" },
        new Colors() { Color = "Dark Orange", Code = "#FF843D" },
        new Colors() { Color = "Dark Red", Code = "#CA3832"},
        new Colors() { Color = "Fuchsia", Code = "#D44FA3" },
        new Colors() { Color = "Hot Pink", Code = "#F23F82" },
        new Colors() { Color = "Indigo", Code = "#2F5D81" },
        new Colors() { Color = "Lime Green", Code = "#4CD242" },
        new Colors() { Color = "Orange Red", Code = "#FE2A00" },
        new Colors() { Color = "Tomato", Code = "#FF745C" },
        new Colors() { Color = "Brown", Code = "#A52A2A" },
        new Colors() { Color = "Maroon", Code = "#800000" },
        new Colors() { Color = "Green", Code = "#008000" },
        new Colors() { Color = "Pink", Code = "#FFC0CB" },
        new Colors() { Color = "Purple", Code = "#800080" }
    };

    public List<ExpandoObject> VehicleData { get; set; } = new List<ExpandoObject>();
    public List<DynamicDictionary> Orders = new List<DynamicDictionary>() { };
    protected override void OnInitialized()
    {
        VehicleData = Enumerable.Range(1, 15).Select((x) =>
        {
            dynamic d = new ExpandoObject();
            d.Id = (1000 + x).ToString();
            d.Text = (new string[] { "Hennessey Venom", "Bugatti Chiron", "Bugatti Veyron Super Sport", "SSC Ultimate Aero", "Koenigsegg CCR", "McLaren F1", "Aston Martin One- 77", "Jaguar XJ220", "McLaren P1", "Ferrari LaFerrari", "Mahindra Jaguar", "Hyundai Toyota", "Jeep Volkswagen", "Tata Maruti Suzuki", "Audi Mercedes Benz"}[x-1]);
            return d;
        }).Cast<ExpandoObject>().ToList<ExpandoObject>();

        Orders = Enumerable.Range(1, 15).Select((x) =>
        {
            dynamic d = new DynamicDictionary();
            d.OrderId = 1000 + x;
            d.CustomerName = (new string[] { "Nancy", "Andrew", "Janet", "Margaret", "Steven", "Michael", "Robert", "Anne", "Nige", "Fuller", "Dodsworth", "Leverling", "Callahan", "Suyama", "Davolio" }[x-1]);
            return d;
        }).Cast<DynamicDictionary>().ToList<DynamicDictionary>();
    }

    public class DynamicDictionary : System.Dynamic.DynamicObject
    {
        Dictionary<string, object> dictionary = new Dictionary<string, object>();
        public override bool TryGetMember(GetMemberBinder binder, out object? result)
        {
            string name = binder.Name;
            return dictionary.TryGetValue(name, out result);
        }
        public override bool TrySetMember(SetMemberBinder binder, object? value)
        {
            if (value != null)
            {
                dictionary[binder.Name] = value;
            }
            return true;
        }
        //The GetDynamicMemberNames method of DynamicObject class must be overridden and return the property names to perform data operation and editing while using DynamicObject.
        public override System.Collections.Generic.IEnumerable<string> GetDynamicMemberNames()
        {
            return this.dictionary.Keys;
        }
    }
}

<style>
    .control-wrapper {
        margin: 30px 40px;
    }

    .example-label {
        font-size: 14px;
        margin-bottom: 6px;
    }
</style>
