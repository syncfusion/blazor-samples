@page "/AutoComplete/Data-Binding"

@using System.Collections.ObjectModel;
@using Syncfusion.Blazor.DropDowns
@using Syncfusion.Blazor.Data
@using System.Dynamic

@*Hidden:Lines*@
@inherits SampleBaseComponent
@*End:Hidden*@

<ActionDescription>
<p>This example demonstrates the AutoComplete's comprehensive data binding support with automatic completion and remote data handling capabilities.</p>

<p>Data binding features:</p>
<ul>
  <li>Type characters and remaining characters auto-fill based on first matched item</li>
  <li>Loader icon appears during remote data retrieval</li>
  <li>Supported data types: Array, ObservableCollection, ExpandoObject, DynamicObject, DataManager</li>
</ul>

<p>DataManager configuration:</p>
<ul>
  <li><a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.DataManager.html#Syncfusion_Blazor_DataManager_Url" target="_blank" rel="noopener" aria-label="Navigate to Url property">DataManager.Url</a> - Service endpoint for data retrieval</li>
  <li><a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.DataManager.html#Syncfusion_Blazor_DataManager_Adaptor" target="_blank" rel="noopener" aria-label="Navigate to Adaptor property">DataManager.Adaptor</a> - ODataAdaptor (default) or alternative adaptors:</li>
</ul>

<p>Adaptor options:</p>
<ul>
  <li><code>UrlAdaptor</code> - For any remote services</li>
  <li><code>ODataAdaptor</code> - For OData endpoints</li>
  <li><code>ODataV4Adaptor</code> - For OData V4 endpoints</li>
  <li><code>WebApiAdaptor</code> - For Web API services</li>
  <li><code>WebMethodAdaptor</code> - For web methods</li>
</ul>

<p>Data binding types in this sample:</p>
<ul>
  <li>Local Data - Countries collection</li>
  <li>Remote Data - Customer data via DataManager</li>
  <li>Observable Collection - Colors data</li>
  <li>ExpandObject - Vehicles data</li>
  <li>DynamicObject - Customers data</li>
</ul>

<p><b>See also</b></p>
<ul>
  <li><a href="https://blazor.syncfusion.com/documentation/autocomplete/data-binding" target="_blank" rel="noopener" aria-label="Navigate to Blazor AutoComplete Data Binding documentation">Blazor AutoComplete - Data Binding</a></li>
  <li><a href="https://blazor.syncfusion.com/documentation/data/getting-started" target="_blank" rel="noopener" aria-label="Navigate to Blazor Data Manager documentation">Blazor Data Manager</a></li>
</ul>
</ActionDescription>


<div class="control-section col-lg-12">
    <div class="row">
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">Local Data</label>
                <SfAutoComplete TValue="string" TItem="Countries" PopupHeight="200px" Placeholder="e.g. Australia" DataSource="@Country" Autofill=true @bind-Value="@CountryValue">
                    <AutoCompleteFieldSettings Value="Name"/>
                </SfAutoComplete>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">Remote Data</label>
                <SfAutoComplete TValue="string" TItem="EmployeeData" PopupHeight="200px" Placeholder="Select a name" Query="@RemoteQuery" Autofill="true" @bind-Value="@EmployeeValue">
                    <SfDataManager Url="https://blazor.syncfusion.com/services/production/api/Employees" Offline="true" CrossDomain="true" Adaptor="Syncfusion.Blazor.Adaptors.WebApiAdaptor"></SfDataManager>
                    <AutoCompleteFieldSettings Value="FirstName"/>
                </SfAutoComplete>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">Observable Collection</label>
                <SfAutoComplete TValue="string" TItem="Colors" PopupHeight="200px" Placeholder="Select a color" DataSource="@ColorsData" @bind-Value="@ColorValue">
                    <AutoCompleteFieldSettings Value="Color"/>
                </SfAutoComplete>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">ExpandoObject</label>
                <SfAutoComplete TItem="ExpandoObject" TValue="string" PopupHeight="200px" Placeholder="Select a vehicle" DataSource="@VehicleData" @bind-Value="@VehicleValue">
                    <AutoCompleteFieldSettings Value="Text"/>
                </SfAutoComplete>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <div class="control-wrapper">
                <label class="example-label">DynamicObject</label>
                <SfAutoComplete TValue="string" TItem="DynamicDictionary" PopupHeight="200px" Placeholder="Select a name" DataSource="@Orders" @bind-Value="@AutoValue">
                    <AutoCompleteFieldSettings Value="CustomerName"/>
                </SfAutoComplete>
            </div>
        </div>
    </div>
</div>

@code{
    public string CountryValue { get; set; } = "France";
    public string EmployeeValue { get; set; } = "Andrew";
    public string ColorValue { get; set; } = "Chocolate";
    public string VehicleValue { get; set; } = "Ferrari LaFerrari";
    public string AutoValue { get; set; } = "Michael";

    public class Countries
    {
        public string? Name { get; set; }
        public string? Code { get; set; }
    }

    public List<Countries> Country = new List<Countries>
    {
        new Countries() { Name = "Australia", Code = "AU" },
        new Countries() { Name = "Bermuda", Code = "BM" },
        new Countries() { Name = "Canada", Code = "CA" },
        new Countries() { Name = "Cameroon", Code = "CM" },
        new Countries() { Name = "Denmark", Code = "DK" },
        new Countries() { Name = "France", Code = "FR" },
        new Countries() { Name = "Finland", Code = "FI" },
        new Countries() { Name = "Germany", Code = "DE" },
        new Countries() { Name = "Greenland", Code = "GL" },
        new Countries() { Name = "Hong Kong", Code = "HK" },
        new Countries() { Name = "India", Code = "IN" },
        new Countries() { Name = "Italy", Code = "IT" },
        new Countries() { Name = "Japan", Code = "JP" },
        new Countries() { Name = "Mexico", Code = "MX" },
        new Countries() { Name = "Norway", Code = "NO" },
        new Countries() { Name = "Poland", Code = "PL" },
        new Countries() { Name = "Switzerland", Code = "CH" },
        new Countries() { Name = "United Kingdom", Code = "GB" },
        new Countries() { Name = "United States", Code = "US" }
    };

    public Query RemoteQuery = new Query();
    public class EmployeeData
    {
        public int EmployeeID { get; set; }
        public string? FirstName { get; set; }
        public string? LastName { get; set; }
        public string? Country { get; set; }
    }

    public class Colors
    {
        public string? Code { get; set; }
        public string? Color { get; set; }
    }

    private ObservableCollection<Colors> ColorsData = new ObservableCollection<Colors>()
    {
        new Colors() { Color = "Chocolate", Code = "#75523C" },
        new Colors() { Color = "Cadet Blue", Code = "#3B8289" },
        new Colors() { Color = "Dark Orange", Code = "#FF843D" },
        new Colors() { Color = "Dark Red", Code = "#CA3832"},
        new Colors() { Color = "Fuchsia", Code = "#D44FA3" },
        new Colors() { Color = "Hot Pink", Code = "#F23F82" },
        new Colors() { Color = "Indigo", Code = "#2F5D81" },
        new Colors() { Color = "Lime Green", Code = "#4CD242" },
        new Colors() { Color = "Orange Red", Code = "#FE2A00" },
        new Colors() { Color = "Tomato", Code = "#FF745C" },
        new Colors() { Color = "Brown", Code = "#A52A2A" },
        new Colors() { Color = "Maroon", Code = "#800000" },
        new Colors() { Color = "Green", Code = "#008000" },
        new Colors() { Color = "Pink", Code = "#FFC0CB" },
        new Colors() { Color = "Purple", Code = "#800080" }
    };

    public List<ExpandoObject> VehicleData { get; set; } = new List<ExpandoObject>();
    public List<DynamicDictionary> Orders = new List<DynamicDictionary>() { };

    protected override void OnInitialized()
    {
        VehicleData = Enumerable.Range(1, 15).Select((x) =>
        {
            dynamic d = new ExpandoObject();
            d.ID = (1000 + x).ToString();
            d.Text = (new string[] { "Hennessey Venom", "Bugatti Chiron", "Bugatti Veyron Super Sport", "SSC Ultimate Aero", "Koenigsegg CCR", "McLaren F1", "Aston Martin One- 77", "Jaguar XJ220", "McLaren P1", "Ferrari LaFerrari", "Mahindra Jaguar", "Hyundai Toyota", "Jeep Volkswagen", "Tata Maruti Suzuki", "Audi Mercedes Benz" }[x - 1]);
            return d;
        }).Cast<ExpandoObject>().ToList<ExpandoObject>();

        Orders = Enumerable.Range(1, 15).Select((x) =>
        {
            dynamic d = new DynamicDictionary();
            d.OrderID = 1000 + x;
            d.CustomerName = (new string[] { "Nancy", "Andrew", "Janet", "Margaret", "Steven", "Michael", "Robert", "Anne", "Nige", "Fuller", "Dodsworth", "Leverling", "Callahan", "Suyama", "Davolio" }[x - 1]);
            return d;
        }).Cast<DynamicDictionary>().ToList<DynamicDictionary>();
    }

    public class DynamicDictionary : System.Dynamic.DynamicObject
    {
        Dictionary<string, object> dictionary = new Dictionary<string, object>();
        public override bool TryGetMember(GetMemberBinder binder, out object? result)
        {
            string name = binder.Name;
            return dictionary.TryGetValue(name, out result);
        }
        public override bool TrySetMember(SetMemberBinder binder, object? value)
        {
            if (value != null)
            {
                dictionary[binder.Name] = value;              
            }
            return true;
        }
        //The GetDynamicMemberNames method of DynamicObject class must be overridden and return the property names to perform data operation and editing while using DynamicObject.
        public override System.Collections.Generic.IEnumerable<string> GetDynamicMemberNames()
        {
            return this.dictionary.Keys;
        }
    }
}

<style>
    .control-wrapper {
        margin: 30px 40px;
    }

    .example-label {
        font-size: 14px;
        margin-bottom: 6px;
    }
</style>
