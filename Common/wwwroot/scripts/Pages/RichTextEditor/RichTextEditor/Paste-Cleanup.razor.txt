
@page "/rich-text-editor/paste-cleanup"
@using Syncfusion.Blazor.DropDowns
@using Syncfusion.Blazor.RichTextEditor
@*Hidden:Lines*@
@inherits SampleBaseComponent
@*End:Hidden*@

<ActionDescription>
<p>
    This example demonstrates the paste options in the Rich Text Editor component. The Blazor Rich Text Editor offers built-in options to paste content from Microsoft Word, Microsoft Outlook, Microsoft Excel, and other websites by filtering out unwanted tags, attributes, and styles. Copy content from Microsoft Office or other websites and paste it into the editor, where it is cleaned up and pasted based on the settings in the properties panel.
  </p>
  <p>
    The Rich Text Editor allows pasting HTML content from Microsoft Word, Microsoft Outlook, Microsoft Excel, and other websites. The editor cleans up the pasted HTML content by:
  </p>
  <ul>
    <li>Converting unformatted HTML elements (MOS XML format) to standard HTML elements.</li>
    <li>Converting Microsoft Office prefixed style properties to proper CSS style properties.</li>
    <li>Removing unwanted tags, CSS styles, and comments from the copied content.</li>
  </ul>
  <p>
    The Rich Text Editor cleans up the pasted content based on properties of <a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.RichTextEditor.RichTextEditorPasteCleanupSettings.html" aria-label="Class reference of RichTextEditorPasteCleanupSettings">RichTextEditorPasteCleanupSettings</a>:
  </p>
  <ul>
    <li>
      <p>Select any option in the <code>Format Option</code> dropdown list for the paste content:</p>
      <ul>
        <li>Select the <a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.RichTextEditor.RichTextEditorPasteCleanupSettings.html#Syncfusion_Blazor_RichTextEditor_RichTextEditorPasteCleanupSettings_Prompt" aria-label="Class reference of Prompt property in Rich Text Editor">Prompt</a> option to invoke a prompt dialog with paste options.</li>
        <li>Select the <a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.RichTextEditor.RichTextEditorPasteCleanupSettings.html#Syncfusion_Blazor_RichTextEditor_RichTextEditorPasteCleanupSettings_PlainText" aria-label="Class reference of PlainText property in Rich Text Editor">Plain Text</a> option to paste content as plain text.</li>
        <li>Select the <a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.RichTextEditor.RichTextEditorPasteCleanupSettings.html#Syncfusion_Blazor_RichTextEditor_RichTextEditorPasteCleanupSettings_KeepFormat" aria-label="Class reference of KeepFormat property in Rich Text Editor">Keep Format</a> option to keep the same format in copied content.</li>
        <li>Select the <code>Clean Format</code> option to remove style formatting from copied content.</li>
      </ul>
    </li>
    <li>
      <p>Fill the <a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.RichTextEditor.RichTextEditorPasteCleanupSettings.html#Syncfusion_Blazor_RichTextEditor_RichTextEditorPasteCleanupSettings_DeniedTags" aria-label="Class reference of Denied Tags property in Rich Text Editor">Denied Tags</a> textbox to ignore tags when pasting HTML content:</p>
      <ul>
        <li><strong>['a[!href]']</strong> - Paste content by filtering anchor tags without the 'href' attribute.</li>
        <li><strong>['a[href, target]']</strong> - Paste content by filtering anchor tags with 'href' and 'target' attributes.</li>
      </ul>
    </li>
    <li>
      <p>Fill the <a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.RichTextEditor.RichTextEditorPasteCleanupSettings.html#Syncfusion_Blazor_RichTextEditor_RichTextEditorPasteCleanupSettings_DeniedAttributes" aria-label="Class reference of Denied Attributes property in Rich Text Editor">Denied Attributes</a> to paste content by filtering out these attributes:</p>
      <ul>
        <li><strong>['id', 'title']</strong> - Removes the 'id' and 'title' attributes from all tags.</li>
      </ul>
    </li>
    <li>
      <p>Fill the <a href="https://help.syncfusion.com/cr/blazor/Syncfusion.Blazor.RichTextEditor.RichTextEditorPasteCleanupSettings.html#Syncfusion_Blazor_RichTextEditor_RichTextEditorPasteCleanupSettings_AllowedStyleProperties" aria-label="Class reference of Allowed Style property in Rich Text Editor">Allowed Style Properties</a> to paste content by accepting only these style attributes:</p>
      <ul>
        <li><strong>['color', 'margin']</strong> - Allows only 'color' and 'margin' style properties in each pasted element.</li>
      </ul>
    </li>
  </ul>
</ActionDescription>


<div class="col-lg-8 control-section">
    <div class="">
        <SfRichTextEditor @bind-Value="@Value">
            <RichTextEditorPasteCleanupSettings Prompt="@Prompt" PlainText="@Plaintext" KeepFormat="@Keepformat" DeniedAttributes="@Deniedattr"
                                                AllowedStyleProperties="@Allowedstyle" DeniedTags="@Deniedtags" />
        </SfRichTextEditor>
    </div>
</div>
<div class="col-lg-4 property-section">
    <div title="Properties">
        <table id="property" title="Properties">
            <tbody>
                <tr>
                    <td>
                        <div>Format Option</div>
                    </td>
                    <td>
                        <div>
                            <SfDropDownList @ref="DropObj" TItem="PasteOptions" TValue="string" PopupHeight="200px" @bind-Value="PasteDefaultValue" DataSource="@Options">
                                <DropDownListFieldSettings Text="Text" Value="Id" />
                                <DropDownListEvents TValue="string" TItem="PasteOptions" ValueChange="ValueChange" />
                            </SfDropDownList>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div>Denied Tags </div>
                    </td>
                    <td>
                        <div>
                            <input type="text" @bind="@DeniedTagsText" class="e-input" @onblur="DeniedTagsblur" placeholder="img[!href], h1" aria-label="Denied Tags"/>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div>Denied Attributes </div>
                    </td>
                    <td>
                        <div>
                            <input type="text" @bind="@DeniedAttributesText" class="e-input" @onblur="DeniedAttributesblur" placeholder="id, title" aria-label="Denied Attributes"/>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div>Allowed Style Properties </div>
                    </td>
                    <td>
                        <div>
                            <input type="text" @bind="@AllowedStylePropertiesText" class="e-input" @onblur="AllowedStylePropertiesblur" placeholder="href, style" aria-label="Style Properties"/>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<style>
    .property-section table td {
        width: 50%;
    }

    .property-section table div {
        padding-left: 10px;
        padding-top: 10px;
    }
</style>

@code {
    private SfDropDownList<string, PasteOptions>? DropObj;
    private string PasteDefaultValue { get; set; } = "prompt";
    private bool Prompt = true;
    private bool Plaintext = false;
    private bool Keepformat = false;

    private string? DeniedTagsText { get; set; }
    private string? DeniedAttributesText { get; set; }
    private string? AllowedStylePropertiesText { get; set; }

    private string[]? Deniedtags { get; set; }
    private string[]? Deniedattr { get; set; }
    
    private string[] Allowedstyle { get; set; } = new string[]
    {
        "background", "background-color", "border", "border-bottom", "border-left", "border-radius",
        "border-right", "border-style", "border-top", "border-width", "clear", "color", "cursor",
        "direction", "display", "float", "font", "font-family", "font-size", "font-weight", "font-style",
        "height", "left", "line-height", "margin", "margin-top", "margin-left",
        "margin-right", "margin-bottom", "max-height", "max-width", "min-height", "min-width",
        "overflow", "overflow-x", "overflow-y", "padding", "padding-bottom", "padding-left", "padding-right",
        "padding-top", "position", "right", "table-layout", "text-align", "text-decoration", "text-indent",
        "top", "vertical-align", "visibility", "white-space", "width"
    };

    private string Value { get; set; } = @"<h4>Paste Cleanup in Rich Text Editor<br></h4><p>The Rich Text Editor automatically <strong>cleans up formatted content</strong> when you paste from external sources like Word, Google Docs, or web pages.</p><p><b>Paste Cleanup properties:</b></p><ul>
                <li><strong>Prompt </strong>- specifies whether to enable the prompt when pasting in Rich Text Editor
                </li>
                <li><strong>Plain Text </strong>- specifies whether to paste as plain text or not in Rich Text Editor.
                </li>
                <li><strong>Keep Format</strong>- specifies whether to keep or remove the format when pasting in Rich Text Editor.
                </li>
                <li><strong>Denied Tags</strong> - specifies the tags to restrict when pasting in Rich Text Editor.
                </li>
                <li><strong>Denied Attributes</strong> - specifies the attributes to restrict when pasting in Rich Text Editor.
                </li>
                <li><strong>Allowed Style Properties</strong> - specifies the allowed style properties when pasting in Rich Text Editor.
                </li>
            </ul><p><span><strong>Try It Out!</strong></span></p><p>Copy content from a web page or document and paste it here. The editor will display a prompt and allow you to input your options.</p>";

    private class PasteOptions
    {
        public string? Id { get; set; }
        public string? Text { get; set; }
    }

    private List<PasteOptions> Options = new List<PasteOptions>()
    {
        new PasteOptions(){ Id= "prompt", Text= "Prompt" },
        new PasteOptions(){ Id= "plainText", Text= "Plain Text" },
        new PasteOptions(){ Id= "keepFormat", Text= "Keep Format" },
        new PasteOptions(){ Id= "cleanFormat", Text= "Clean Format" },
    };

    private void ValueChange(@Syncfusion.Blazor.DropDowns.ChangeEventArgs<string, PasteOptions> args)
    {
        if (args.Value == "prompt")
        {
            this.Prompt = true;
        }
        else if (args.Value == "plainText")
        {
            this.Prompt = false;
            this.Plaintext = true;
        }
        else if (args.Value == "keepFormat")
        {
            this.Prompt = false;
            this.Plaintext = false;
            this.Keepformat = true;
        }
        else if (args.Value == "cleanFormat")
        {
            this.Prompt = false;
            this.Plaintext = false;
            this.Keepformat = false;
        }
    }

    private void DeniedTagsblur(Microsoft.AspNetCore.Components.Web.FocusEventArgs e)
    {
        if (this.DeniedTagsText != null)
        {
            this.Deniedtags = this.DeniedTagsText.Split(',');
        }
    }

    private void DeniedAttributesblur(Microsoft.AspNetCore.Components.Web.FocusEventArgs e)
    {
        if (this.DeniedAttributesText != null)
        {
            this.Deniedattr = this.DeniedAttributesText.Split(',');
        }
    }

    private void AllowedStylePropertiesblur(Microsoft.AspNetCore.Components.Web.FocusEventArgs e)
    {
        if (this.AllowedStylePropertiesText != null)
        {
            this.Allowedstyle = this.AllowedStylePropertiesText.Split(',');
        }
    }
}
